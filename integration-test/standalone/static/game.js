"use strict";const getGlobalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==this)return this;throw new Error("Unable to locate global `this`")},globalObject=getGlobalThis();var loader;!function(x){let T=0,R=[],A=[];const E={baseUrl:""},S={};function d(x,R,A){let E=null,C={},I=null;"function"==typeof x?C=x:"string"==typeof x?(E=x,"function"==typeof R?C=R:R instanceof Array&&(I=R,C=A)):x instanceof Array&&(I=x,"function"==typeof R&&(C=R)),I=I||["require","exports","module"],null===E&&(E="unnamed-module-"+T++),E=g(E),I=(I||[]).map((x=>function(x,T){return x?b(T,x):T}(E,x))),S[E]||(S[E]={name:E,parent:null,dclamd:1,dependencies:I,handlers:[],exports:{},dependants:new Set}),S[E].dependencies=I,p(I,(function(x){const T=S[E];if(!T)throw new Error("Could not access registered module "+E);let R=T.exports;R="function"==typeof C?C.apply(globalObject,x)||R:C,T.exports=R,u(E)}),(x=>{if("function"!=typeof onerror)throw x;onerror(x)}),E)}function u(x){const T=S[x];if(!T)throw new Error("Could not access registered module "+x);T.dclamd=2;let R=T.handlers;if(R&&R.length)for(let T=0;T<R.length;T++)R[T](S[x])}function c(x,T,R){if(!S[x])return null;if(x==T||50==R)return[x];const A=S[x].dependencies;for(let E=0,S=A.length;E<S;E++){let S=c(A[E],T,R+1);if(null!==S)return S.push(x),S}return null}function a(x,T){let R=S[x];if(!R)return!1;let A={};for(let x in S)A[x]=!1;let E=[];for(E.push(R),A[x]=!0;E.length>0;){let x=E.shift().dependencies;if(x)for(let R=0,C=x.length;R<C;R++){let C=x[R];if(C===T)return!0;let I=S[C];I&&!A[C]&&(A[C]=!0,E.push(I))}}return!1}function p(x,T,R,E){let C=new Array(x.length).fill(null),I=0,z=!1;if("string"==typeof x){if(S[x]){if(1===S[x].dclamd)throw new Error(`Trying to load ${x} from ${E}. The first module is still loading.`);return S[x]}throw new Error(x+" has not been defined. Please include it as a dependency in "+E+"'s define()")}const P=x.length;for(let O=0;O<P;O++)switch(x[O]){case"require":let h=function(x,T,R){return p(x,T,R,E)};h.toUrl=function(x){return b(x,E)},C[O]=h,I++;break;case"exports":if(!S[E])throw new Error("Parent module "+E+" not registered yet");C[O]=S[E].exports,I++;break;case"module":C[O]={id:E,uri:b(E)},I++;break;default:{const U=x[O],m=()=>{C[O]=S[U].exports,I++,I===P&&T&&(z=!0,T(C))};if(a(U,E)){const x=c(U,E,0);x&&(x.reverse(),x.push(U),A.push(x)),w(U,(()=>{}),R,E),m()}else w(U,m,R,E);break}}!z&&I===P&&T&&T(C)}function h(x,T){return function(){return dcl.callRpc(x,T.name,R.slice.call(arguments,0))}}function w(x,T,R,A){if(S[x])return S[x].dependants.add(A),void(1===S[x].dclamd?T&&S[x].handlers.push(T):T&&T(S[x]));if(S[x]={name:x,parent:A,dclamd:1,handlers:[T],dependencies:[],dependants:new Set([A]),exports:{}},0===x.indexOf("@")){let T=S[x].exports;if("function"!=typeof dcl.loadModule)throw new Error("Asynchronous modules will not work because loadModule function is not present");dcl.loadModule(x,T).then((R=>{for(let x in R.methods){const A=R.methods[x];T[A.name]=h(R.rpcHandle,A)}u(x)})).catch((x=>{R(x)}))}}function g(x){let T,R=x;for(T=/\/\.\//;T.test(R);)R=R.replace(T,"/");for(R=R.replace(/^\.\//g,""),T=/\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//;T.test(R);)R=R.replace(T,"/");return R=R.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//,""),R=R.replace(/^\//g,""),R}function b(x,T){switch(x){case"require":case"exports":case"module":return x}return T?function(x,T){let R=x;if(!R.startsWith("@")&&(R.startsWith("./")||R.startsWith("../"))){const x=T.split("/");x.pop(),R=g(x.join("/")+"/"+R)}return R}(x,T):g(x)}x.config=function(x){if("object"==typeof x)for(let T in x)x.hasOwnProperty(T)&&(E[T]=x[T])},x.define=d,function(x){x.amd={},x.modules=S}(d=x.define||(x.define={})),x.require=p,"undefined"!=typeof dcl&&dcl.onStart((()=>{const x=new Set,T=[];for(let R in S)S[R]&&(1===S[R].dclamd&&T.push(S[R]),S[R].dependencies.forEach((T=>{"require"!=T&&"exports"!=T&&"module"!=T&&(S[T]||x.add(T))})));const R=[];if(A.length&&R.push(`\n> Cyclic dependencies: ${A.map((x=>"\n  - "+x.join(" -> "))).join("")}`),x.size&&R.push(`\n> Undeclared/unknown modules: ${Array.from(x).map((x=>"\n  - "+x)).join("")}`),T.length&&R.push(`\n> These modules didn't load: ${T.map((x=>"\n  - "+x.name)).join("")}.\n`),R.length)throw new Error(R.join("\n"))})),p.toUrl=b}(loader||(loader={})),globalObject.define=loader.define,globalObject.dclamd=loader,function(x){var T=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(x){return x.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(x){return x.firstPersonCameraEntity}},t}(),n=function(x,T){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,T){x.__proto__=T}||function(x,T){for(var R in T)Object.prototype.hasOwnProperty.call(T,R)&&(x[R]=T[R])})(x,T)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function o(x,T){if("function"!=typeof T&&null!==T)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function o(){this.constructor=x}n(x,T),x.prototype=null===T?Object.create(T):(o.prototype=T.prototype,new o)}var i=function(){return(i=Object.assign||function(x){for(var T,R=1,A=arguments.length;R<A;R++)for(var E in T=arguments[R])Object.prototype.hasOwnProperty.call(T,E)&&(x[E]=T[E]);return x}).apply(this,arguments)};function r(x,T,R,A){var E,S=arguments.length,C=S<3?T:null===A?A=Object.getOwnPropertyDescriptor(T,R):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(x,T,R,A);else for(var I=x.length-1;I>=0;I--)(E=x[I])&&(C=(S<3?E(C):S>3?E(T,R,C):E(T,R))||C);return S>3&&C&&Object.defineProperty(T,R,C),C}function u(x){var T="function"==typeof Symbol&&Symbol.iterator,R=T&&x[T],A=0;if(R)return R.call(x);if(x&&"number"==typeof x.length)return{next:function(){return x&&A>=x.length&&(x=void 0),{value:x&&x[A++],done:!x}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(x,T){var R="function"==typeof Symbol&&x[Symbol.iterator];if(!R)return x;var A,E,S=R.call(x),C=[];try{for(;(void 0===T||T-- >0)&&!(A=S.next()).done;)C.push(A.value)}catch(x){E={error:x}}finally{try{A&&!A.done&&(R=S.return)&&R.call(S)}finally{if(E)throw E.error}}return C}function h(x,T){for(var R=0,A=T.length,E=x.length;R<A;R++,E++)x[E]=T[R];return x}var R=0;function l(){for(var x=[],T=0;T<arguments.length;T++)x[T]=arguments[T];"undefined"!=typeof dcl?dcl.log.apply(dcl,h([],p(x))):console.log.apply(console,h(["DEBUG:"],p(x)))}function d(x,T){"undefined"!=typeof dcl?dcl.error(x,T):console.error("ERROR:",x,T)}function f(x){if(R++,0===x.length)throw new Error("newId(type: string): type cannot be empty");return x+R.toString(36)}function y(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(x){var T=16*Math.random()|0;return("x"===x?T:3&T|8).toString(16)}))}function v(x,T){for(var R=[],A=0;A<x;++A)R.push(T());return R}var A=[];function _(x){if(!("__event_name__"in x)||"string"!=typeof x.__event_name__)throw new Error("The EventConstructor is not registered");return x.__event_name__}var E=function(){function t(){this.listeners={}}return t.prototype.addListener=function(x,T,R){if(!x||"function"!=typeof x)throw new Error("Invalid EventConstructor");var A=_(x),E=this.listeners[A];E||(E=this.listeners[A]=[]);for(var S=0;S<E.length;S++)if(E[S].listener===T)throw new Error("The provided listener is already registered");return E.push({listener:T,fn:R}),this},t.prototype.removeListener=function(x,T){if(!T||"function"!=typeof T)throw new Error("Invalid EventConstructor");var R=_(T),A=this.listeners[R];if(!A)return!1;for(var E=0;E<A.length;E++)if(A[E].listener===x)return A.splice(E,1),!0;return!1},t.prototype.fireEvent=function(x){var T=_(x.constructor),R=this.listeners[T];if(R)for(var A=0;A<R.length;A++)try{var E=R[A];E.fn.call(E.listener,x)}catch(x){d(x)}return this},t}();function w(){var x=f("EV");if(-1!==A.indexOf(x))throw new Error("The event name "+x+" is already taken");return A.push(x),function(T){return T.__event_name__=x,T}}var S,C=r([w()],(function(x,T,R){this.entity=x,this.componentName=T,this.component=R})),I=r([w()],(function(x,T,R){this.entity=x,this.componentName=T,this.classId=R})),z=r([w()],(function(x,T){this.entity=x,this.parent=T}));x.UIValueType=void 0,(S=x.UIValueType||(x.UIValueType={}))[S.PERCENT=0]="PERCENT",S[S.PIXELS=1]="PIXELS";var P=function(){function e(T){if(this.type=x.UIValueType.PIXELS,"string"==typeof T){var R=T;R.indexOf("px")>-1?this.type=x.UIValueType.PIXELS:R.indexOf("%")>-1&&(this.type=x.UIValueType.PERCENT),this.value=parseFloat(R)}else this.value=T}return e.prototype.toString=function(){var T=this.value.toString();return this.type===x.UIValueType.PERCENT?T+="%":T+="px",T},e}(),O="__name__symbol_",U="__classId__symbol_",H="__component__id_",k=r([w()],(function(x,T,R){this.componentId=x,this.componentName=T,this.classId=R})),V=r([w()],(function(x){this.componentId=x})),W=r([w()],(function(x,T){this.componentId=x,this.component=T}));function M(x,T){return function(R){if(R.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+R.originalClassName+" with: "+x);var A=R,i=function(){var R=Array.prototype.slice.call(arguments),E=new(A.bind.apply(A,h([void 0],p(R))));return Object.defineProperty(E,O,{enumerable:!1,writable:!1,configurable:!1,value:x}),void 0!==T&&Object.defineProperty(E,U,{enumerable:!1,writable:!1,configurable:!1,value:T}),E};return void 0!==T&&(i.__classId__symbol_=T),i.__name__symbol_=x,i.isComponent=!0,i.originalClassName=x,(i.prototype=R.prototype).constructor=R,i}}function F(x,T){return function(R){if(R.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+R.originalClassName+" with: "+x);if("number"!=typeof T||isNaN(T))throw new Error("classId: "+T+" is an invalid integer");var A=R,i=function(){if(!F.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var R=Array.prototype.slice.call(arguments),E=new(A.bind.apply(A,h([void 0],p(R)))),S=f("C");return Object.defineProperty(E,O,{enumerable:!1,writable:!1,configurable:!1,value:x}),Object.defineProperty(E,H,{enumerable:!1,writable:!1,configurable:!1,value:S}),void 0!==T&&Object.defineProperty(E,U,{enumerable:!1,writable:!1,configurable:!1,value:T}),F.engine&&F.engine.registerComponent(E),E};return void 0!==T&&(i.__classId__symbol_=T),i.__name__symbol_=x,i.isComponent=!0,i.isDisposableComponent=!0,i.originalClassName=x,(i.prototype=R.prototype).constructor=R,i}}function L(x){if(!x)throw new TypeError(x+" is not a component.");if(x.__name__symbol_)return x.__name__symbol_;throw new TypeError(x+" is not a registered component.")}function N(x){if(!x)throw new TypeError(x+" is not a component.");if(x.__classId__symbol_)return x.__classId__symbol_;if(!x.__name__symbol_)throw new TypeError(x+" is not a registered component.");return null}function D(x){if(!x)throw new TypeError(x+" is not a component.");if(x.__component__id_)return x.__component__id_;throw new TypeError(x+" is not a registered disposable component.")}!function(x){x.engine=null}(F||(F={}));var G=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(x,T){if(delete x[T]){var R=T+"_"+Math.random();x[R]=void 0,Object.defineProperty(x,R,i(i({},Object.getOwnPropertyDescriptor(x,R)),{enumerable:!1})),Object.defineProperty(x,T.toString(),{get:function(){return this[R]},set:function(x){var A=this[R];if(this.data[T]=x?D(x):null,this[R]=x,x!==A){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](T,x,A)}},enumerable:!0})}},t.field=function(x,T){delete x[T]&&Object.defineProperty(x,T.toString(),{get:function(){return this.data[T]},set:function(x){var R=this.data[T];if(this.data[T]=x,x!==R){this.dirty=!0;for(var A=0;A<this.subscriptions.length;A++)this.subscriptions[A](T,x,R)}},enumerable:!0})},t.uiValue=function(x,T){delete x[T]&&Object.defineProperty(x,T.toString(),{get:function(){return this.data[T].toString()},set:function(x){var R=this.data[T],A=new P(x);if(this.data[T]=A,A!==R){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](T,A,R)}},enumerable:!0})},t.readonly=function(x,T){delete x[T]&&Object.defineProperty(x,T.toString(),{get:function(){if(T in this.data==0)throw new Error("The field "+T+" is uninitialized");return this.data[T]},set:function(x){if(T in this.data)throw new Error("The field "+T+" is readonly");this.data[T]=x,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(x){return this.subscriptions.push(x),this},t.prototype.toJSON=function(){return this.data},t}();function B(x){return H in x}var j=function(){function t(){for(var x=[],T=0;T<arguments.length;T++)x[T]=arguments[T];if(this.entities=[],this.active=!1,this._requiresNames=[],!x)throw new Error("ComponentGroup: Could not load the requires list");if(!(x instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return x.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(T){var A=x[T],E=null;if(!A)throw new Error("ComponentGroup: the required component at location "+T+" is invalid");try{E=L(A)}catch(x){throw new Error("ComponentGroup: the required component at location "+T+" is not registered as a @Component. Remember to provide the class of the component, not the name")}if(R._requiresNames.some((function(x){return x===E})))throw new Error("ComponentGroup: the required component list has a repeated name "+E);R._requiresNames.push(E)},R=this,A=0;A<x.length;A++)n(A)}return t.prototype.hasEntity=function(x){return!!x.isAddedToEngine()&&-1!==this.entities.indexOf(x)},t.prototype.addEntity=function(x){if(!x.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(x)&&this.entities.push(x)},t.prototype.removeEntity=function(x){var T=this.entities.indexOf(x);-1!==T&&this.entities.splice(T,1)},t.prototype.componentRemoved=function(x,T){-1!==this._requiresNames.indexOf(T)&&this.removeEntity(x)},t.prototype.meetsRequirements=function(x){for(var T=0;T<this._requiresNames.length;T++)if(!(this._requiresNames[T]in x.components))return!1;return!0},t}(),X=function(){function t(x){this.name=x,this.children={},this.eventManager=null,this.alive=!1,this.uuid=f("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(x){if("function"==typeof x)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof x)throw new Error("You passed a "+typeof x+", an instance of component is expected");var T=L(x);if(this.components[T]){if(this.components[T]===x)return x;this.removeComponent(this.components[T],!1)}return this.addComponent(x)},t.prototype.hasComponent=function(x){var T=typeof x;if("string"!==T&&"object"!==T&&"function"!==T)throw new Error("Entity#has(component): component is not a class, name or instance");if(null==x)return!1;var R="string"===T?x:L(x),A=this.components[R];return!!A&&("object"===T?A===x:"function"!==T||A instanceof x)},t.prototype.getComponent=function(x){var T=typeof x;if("string"!==T&&"function"!==T)throw new Error("Entity#get(component): component is not a class or name");var R="string"===T?x:L(x),A=this.components[R];if(!A)throw new Error('Can not get component "'+R+'" from entity "'+this.identifier+'"');if("function"===T){if(A instanceof x)return A;throw new Error('Can not get component "'+R+'" from entity "'+this.identifier+'" (by instance)')}return A},t.prototype.getComponentOrNull=function(x){var T=typeof x;if("string"!==T&&"function"!==T)throw new Error("Entity#getOrNull(component): component is not a class or name");var R="string"===T?x:L(x),A=this.components[R];return A?"function"===T?A instanceof x?A:null:A:null},t.prototype.getComponentOrCreate=function(x){if("function"!=typeof x)throw new Error("Entity#getOrCreate(component): component is not a class");var T=this.getComponentOrNull(x);return T||(L(T=new x),this.addComponentOrReplace(T)),T},t.prototype.addComponent=function(x){if("object"!=typeof x)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var T=L(x),R=N(x);if(this.components[T])throw new Error('A component of type "'+T+'" is already present in entity "'+this.identifier+'"');this.components[T]=x,this.eventManager&&this.eventManager.fireEvent(new I(this,T,R));var A=x;return"function"==typeof A.addedToEntity&&A.addedToEntity(this),x},t.prototype.removeComponent=function(x,T){void 0===T&&(T=!0);var R=typeof x;if("string"!==R&&"function"!==R&&"object"!==R)throw new Error("Entity#remove(component): component is not a class, class or name");var A="string"===R?x:L(x),E=this.components[A];if(E){if("function"===R)return E instanceof x?(delete this.components[A],void(E&&(T&&this.eventManager&&this.eventManager.fireEvent(new C(this,A,E)),"function"==typeof E.removedFromEntity&&E.removedFromEntity(this)))):void l('Entity Warning: Trying to remove wrong (by constructor) component "'+A+'" from entity "'+this.identifier+'"');delete this.components[A],E&&(T&&this.eventManager&&this.eventManager.fireEvent(new C(this,A,E)),"function"==typeof E.removedFromEntity&&E.removedFromEntity(this))}else l('Entity Warning: Trying to remove inexisting component "'+A+'" from entity "'+this.identifier+'"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(x){var T;if(x&&"getEntityRepresentation"in x){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");T=x.getEntityRepresentation(this.engine)}else T=!x&&this.engine?this.engine.rootEntity:x;var R=this.getParent();if(T===this)throw new Error('Failed to set parent for entity "'+this.identifier+"\": An entity can't set itself as a its own parent");if(T===R)return this;var A=this.getCircularAncestor(T);if(A)throw new Error('Failed to set parent for entity "'+this.identifier+'": Circular parent references are not allowed (See entity "'+A+'")');return R&&delete R.children[this.uuid],null!==T&&"0"!==T.uuid&&(!T.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),T.isAddedToEngine()&&!this.isAddedToEngine()&&T.engine.addEntity(this)),this._parent=T||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new z(this,T)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(x){for(var T=this.engine?this.engine.rootEntity:null,R=x;R&&R!==T;){var A=R.getParent();if(A===this)return R.uuid;R=A}return null},t.prototype.registerAsChild=function(){var x=this.getParent();this.uuid&&x&&(x.children[this.uuid]=this)},t}(),Z=function(){function t(x){this.eventManager=new E,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(I,this,this.componentAddedHandler),this.eventManager.addListener(C,this,this.componentRemovedHandler),this.rootEntity=x,this.firstPersonCameraEntity=new X,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new X,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(x){var T=x.getParent();if(x.isAddedToEngine())return x;for(var R in x.eventManager=this.eventManager,x.engine=this,this._entities[x.uuid]=x,this.checkRequirementsAndAdd(x),T?T.isAddedToEngine()||T===this.rootEntity||l("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+T.uuid):x.setParent(this.rootEntity),x.alive=!0,x.children){var A=x.children[R];A&&(A.isAddedToEngine()||this.addEntity(A))}return x},t.prototype.removeEntity=function(x){var T=x.uuid;if(x.isAddedToEngine()){for(var R in x.components){var A=this._componentGroups[R];if(A)for(var E in A)A[E].removeEntity(x);delete this.entityLists[R][T]}for(var S=0;S<this.simpleSystems.length;S++){var C=this.simpleSystems[S];C.onRemoveEntity&&C.onRemoveEntity(x)}for(var S in x.children){var I=x.children[S];I&&this.removeEntity(I)}return x.alive=!1,x.eventManager=null,delete this._entities[T],!0}for(var R in l("Engine: Trying to remove non existent entity from engine."),x.isAddedToEngine()?l("Engine: Entity id: "+T):l('Engine: Entity "'+x.uuid+'" has not been added to any engine yet.'),l("Engine: Entity's components:"),x.components)l(R);return!1},t.prototype.addSystem=function(x,T){if(void 0===T&&(T=0),-1!==this.addedSystems.indexOf(x))return l("Engine: Trying to add a system that is already added. Aborting"),x;if(this.systems.length>0)for(var R=0;R<this.systems.length;R++){var A=this.systems[R],E=R===this.systems.length-1;if(A.priority>T){this.addedSystems.push(x),this.systems.splice(R,0,{system:x,priority:T});break}if(E){this.addedSystems.push(x),this.systems.splice(R+1,0,{system:x,priority:T});break}}else this.addedSystems.push(x),this.systems.splice(1,0,{system:x,priority:T});return this.registerSystem(x),x},t.prototype.removeSystem=function(x){var T=this.addedSystems.indexOf(x);if(-1!==T){x.active=!1,x.deactivate&&x.deactivate(),this.addedSystems.splice(T,1);for(var R=0;R<this.systems.length;R++)this.systems[R].system===x&&this.systems.splice(R,1);return!0}return!1},t.prototype.update=function(x){for(var T in this.systems){var R=this.systems[T].system;if(R.active&&R.update)try{R.update(x)}catch(x){d(x)}}return this},t.prototype.getEntitiesWithComponent=function(x){var T="string"==typeof x?x:L(x);return T in this.entityLists?this.entityLists[T]:this.entityLists[T]={}},t.prototype.registerComponent=function(x){var T=D(x),R=L(x),A=N(x);this._disposableComponents[T]=x,null!==A&&(this.eventManager.fireEvent(new k(T,R,A)),this.eventManager.fireEvent(new W(T,x)))},t.prototype.disposeComponent=function(x){var T=D(x);return delete this._disposableComponents[T]&&(this.eventManager.fireEvent(new V(T)),x.onDispose&&x.onDispose(),!0)},t.prototype.updateComponent=function(x){this.eventManager.fireEvent(new W(D(x),x))},t.prototype.getComponentGroup=function(){for(var x=[],T=0;T<arguments.length;T++)x[T]=arguments[T];var R=void 0;if(x.length>0&&(z=this._componentGroups[L(x[0])]))for(var A=x.slice(),E=0;E<z.length;E++){var S=z[E];if(A.length===S.requires.length){for(var C=0;C<A.length&&-1!==S.requires.indexOf(A[C]);C++)C===A.length-1&&(R=S);if(R)break}}if(R)return R;(R=new(j.bind.apply(j,h([void 0],p(x))))).active=!0;var I=R.requiresNames;for(E=0;E<I.length;E++){var z,P=I[E];(z=this._componentGroups[P])||(this._componentGroups[P]=z=[]),-1===z.indexOf(R)&&z.push(R)}for(var O in this._entities)this.checkRequirements(this._entities[O],R);return R},t.prototype.removeComponentGroup=function(x){if(x.active){x.active=!1;for(var T=x.requiresNames,R=0;R<T.length;R++){var A=T[R],E=this._componentGroups[A];if(E){var S=E.indexOf(x);-1!==S&&E.splice(S,1)}}return!0}return!1},t.prototype.registerSystem=function(x){x.active=!0,x.activate&&x.activate(this),this.simpleSystems.push(x)},t.prototype.checkRequirementsAndAdd=function(x){if(x.isAddedToEngine()){for(var T in x.components){T in this.entityLists||(this.entityLists[T]={}),this.entityLists[T][x.uuid]=x;var R=this._componentGroups[T];if(R)for(var A in R)this.checkRequirements(x,R[A])}for(var E=0;E<this.simpleSystems.length;E++){var S=this.simpleSystems[E];S.onAddEntity&&S.onAddEntity(x)}}},t.prototype.checkRequirements=function(x,T){T.meetsRequirements(x)?T.hasEntity(x)||T.addEntity(x):T.hasEntity(x)&&T.removeEntity(x)},t.prototype.componentAddedHandler=function(x){var T,R=x.entity,A=x.componentName;if(R.isAddedToEngine()){this.entityLists[A]?this.entityLists[A][R.uuid]=R:this.entityLists[A]=((T={})[R.uuid]=R,T);var E=this._componentGroups[A];if(E)for(var S in E)this.checkRequirements(R,E[S])}},t.prototype.componentRemovedHandler=function(x){var T=x.entity,R=x.componentName;if(T.isAddedToEngine()){delete this.entityLists[R][T.uuid];var A=this._componentGroups[R];if(A)for(var E in A)this.checkRequirements(T,A[E])}},t}(),J=Promise.resolve().then.bind(Promise.resolve());function q(x){var T=J(x);return T.isComplete=!1,T.then((function(x){T.isComplete=!0,T.result=x,T.didFail=!1})).catch((function(x){T.isComplete=!0,T.error=x,T.didFail=!0,d("executeTask: FAILED "+x.toString(),x)})),T}var Q,K,$=function(){function t(x,T,R,A){void 0===T&&(T=!1),this.initalize(x,T,R,A)}return t.prototype.initalize=function(x,T,R,A){return void 0===T&&(T=!1),this.mask=x,this.skipNextObservers=T,this.target=R,this.currentTarget=A,this},t}(),Y=function(x,T,R){void 0===R&&(R=null),this.callback=x,this.mask=T,this.scope=R,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},et=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(x,T,R,A){var E,S;void 0===R&&(R=-1),void 0===A&&(A=null);var C=new t;C._observers=new Array,C._observables=x;try{for(var I=u(x),z=I.next();!z.done;z=I.next()){var P=z.value.add(T,R,!1,A);P&&C._observers.push(P)}}catch(x){E={error:x}}finally{try{z&&!z.done&&(S=I.return)&&S.call(I)}finally{if(E)throw E.error}}return C},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var x=0;x<this._observers.length;x++)this._observables[x].remove(this._observers[x]);this._observers=null,this._observables=null},t}(),nt=function(){function t(x){this._observers=new Array,this._onObserverAdded=null,this._eventState=new $(0),x&&(this._onObserverAdded=x)}return t.prototype.add=function(x,T,R,A,E){if(void 0===T&&(T=-1),void 0===R&&(R=!1),void 0===A&&(A=null),void 0===E&&(E=!1),!x)return null;var S=new Y(x,T,A);return S.unregisterOnNextCall=E,R?this._observers.unshift(S):this._observers.push(S),this._onObserverAdded&&this._onObserverAdded(S),S},t.prototype.addOnce=function(x){return this.add(x,void 0,void 0,void 0,!0)},t.prototype.remove=function(x){return!!x&&-1!==this._observers.indexOf(x)&&(this._deferUnregister(x),!0)},t.prototype.removeCallback=function(x,T){for(var R=0;R<this._observers.length;R++)if(this._observers[R].callback===x&&(!T||T===this._observers[R].scope))return this._deferUnregister(this._observers[R]),!0;return!1},t.prototype.notifyObservers=function(x,T,R,A){var E,S;if(void 0===T&&(T=-1),!this._observers.length)return!0;var C=this._eventState;C.mask=T,C.target=R,C.currentTarget=A,C.skipNextObservers=!1,C.lastReturnValue=x;try{for(var I=u(this._observers),z=I.next();!z.done;z=I.next()){var P=z.value;if(!P._willBeUnregistered&&(P.mask&T&&(P.scope?C.lastReturnValue=P.callback.apply(P.scope,[x,C]):C.lastReturnValue=P.callback(x,C),P.unregisterOnNextCall&&this._deferUnregister(P)),C.skipNextObservers))return!1}}catch(x){E={error:x}}finally{try{z&&!z.done&&(S=I.return)&&S.call(I)}finally{if(E)throw E.error}}return!0},t.prototype.notifyObserversWithPromise=function(x,T,R,A){var E=this;void 0===T&&(T=-1);var S=Promise.resolve(x);if(!this._observers.length)return S;var C=this._eventState;return C.mask=T,C.target=R,C.currentTarget=A,C.skipNextObservers=!1,this._observers.forEach((function(R){C.skipNextObservers||R._willBeUnregistered||R.mask&T&&(S=R.scope?S.then((function(T){return C.lastReturnValue=T,R.callback.apply(R.scope,[x,C])})):S.then((function(T){return C.lastReturnValue=T,R.callback(x,C)})),R.unregisterOnNextCall&&E._deferUnregister(R))})),S.then((function(){return x}))},t.prototype.notifyObserver=function(x,T,R){void 0===R&&(R=-1);var A=this._eventState;A.mask=R,A.skipNextObservers=!1,x.callback(T,A)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var x=new t;return x._observers=this._observers.slice(0),x},t.prototype.hasSpecificMask=function(x){var T,R;void 0===x&&(x=-1);try{for(var A=u(this._observers),E=A.next();!E.done;E=A.next()){var S=E.value;if(S.mask&x||S.mask===x)return!0}}catch(x){T={error:x}}finally{try{E&&!E.done&&(R=A.return)&&R.call(A)}finally{if(T)throw T.error}}return!1},t.prototype._deferUnregister=function(x){var T=this;x.unregisterOnNextCall=!1,x._willBeUnregistered=!0,q((function(){return function(x,T,R,A){return new(R||(R=Promise))((function(T,E){function s(x){try{u(A.next(x))}catch(x){E(x)}}function a(x){try{u(A.throw(x))}catch(x){E(x)}}function u(x){var A;x.done?T(x.value):(A=x.value,A instanceof R?A:new R((function(x){x(A)}))).then(s,a)}u((A=A.apply(x,[])).next())}))}(T,0,void 0,(function(){return function(x,T){var R,A,E,S,C={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return S={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(S[Symbol.iterator]=function(){return this}),S;function a(S){return function(I){return function(S){if(R)throw new TypeError("Generator is already executing.");for(;C;)try{if(R=1,A&&(E=2&S[0]?A.return:S[0]?A.throw||((E=A.return)&&E.call(A),0):A.next)&&!(E=E.call(A,S[1])).done)return E;switch(A=0,E&&(S=[2&S[0],E.value]),S[0]){case 0:case 1:E=S;break;case 4:return C.label++,{value:S[1],done:!1};case 5:C.label++,A=S[1],S=[0];continue;case 7:S=C.ops.pop(),C.trys.pop();continue;default:if(!((E=(E=C.trys).length>0&&E[E.length-1])||6!==S[0]&&2!==S[0])){C=0;continue}if(3===S[0]&&(!E||S[1]>E[0]&&S[1]<E[3])){C.label=S[1];break}if(6===S[0]&&C.label<E[1]){C.label=E[1],E=S;break}if(E&&C.label<E[2]){C.label=E[2],C.ops.push(S);break}E[2]&&C.ops.pop(),C.trys.pop();continue}S=T.call(x,C)}catch(x){S=[6,x],A=0}finally{R=E=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}([S,I])}}}(this,(function(T){return[2,this._remove(x)]}))}))}))},t.prototype._remove=function(x){if(!x)return!1;var T=this._observers.indexOf(x);return-1!==T&&(this._observers.splice(T,1),!0)},t}(),ot=r([w()],(function(x,T){this.uuid=x,this.payload=T})),it=r([w()],(function(x){this.payload=x})),rt=r([w()],(function(x){this.payload=x}));function tt(x){return function(){K&&K.subscribe(x)}}var st=new nt(tt("cameraModeChanged")),at=new nt(tt("idleStateChanged")),ut=new nt(tt("onEnterScene")),pt=ut,lt=new nt(tt("onLeaveScene")),dt=lt,ct=new nt(tt("sceneStart")),ft=new nt(tt("playerExpression")),yt=new nt(tt("videoEvent"));function ht(x){(K=x)&&K.onEvent((function(x){switch(x.type){case"onEnterScene":return void ut.notifyObservers(x.data);case"onLeaveScene":return void lt.notifyObservers(x.data);case"cameraModeChanged":return void st.notifyObservers(x.data);case"idleStateChanged":return void at.notifyObservers(x.data);case"sceneStart":return void ct.notifyObservers(x.data);case"playerExpression":return void ft.notifyObservers(x.data);case"videoEvent":var T=x.data,R=F.engine.disposableComponents[T.componentId];return R&&R.update(T),void yt.notifyObservers(T)}}))}var vt,mt,gt=function(){function t(x){this.dcl=x,this.cachedComponents={}}return t.prototype.activate=function(x){var T=this;this.engine=x,x.eventManager.addListener(I,this,this.componentAdded),x.eventManager.addListener(C,this,this.componentRemoved),x.eventManager.addListener(k,this,this.disposableComponentCreated),x.eventManager.addListener(V,this,this.disposableComponentRemoved),x.eventManager.addListener(W,this,this.disposableComponentUpdated),x.eventManager.addListener(z,this,this.parentChanged);var R=x.rootEntity.uuid;this.dcl.addEntity(R),this.dcl.onUpdate((function(R){x.update(R),T.presentEntities()})),this.dcl.onEvent((function(T){var R=T.data;switch(T.type){case"uuidEvent":x.eventManager.fireEvent(new ot(R.uuid,R.payload));break;case"raycastResponse":("HitFirst"===R.queryType||"HitAll"===R.queryType)&&x.eventManager.fireEvent(new it(R));break;case"pointerEvent":x.eventManager.fireEvent(new rt(R.payload))}}))},t.prototype.onAddEntity=function(x){if(x&&x.isAddedToEngine()){var T=x.uuid,R=x.getParent();for(var A in this.dcl.addEntity(T),R&&this.dcl.setParent(T,R.uuid),this.cachedComponents[T]={},x.components){var E=x.components[A],S=N(E);if(null!==S)if(B(E))this.dcl.attachEntityComponent(x.uuid,A,D(E));else{var C=JSON.stringify(E);this.dcl.updateEntityComponent(T,A,S,C),this.cachedComponents[T][A]=C}}}},t.prototype.onRemoveEntity=function(x){if(x.isAddedToEngine()){var T=x.uuid;this.dcl.removeEntity(T),delete this.cachedComponents[T]}},t.prototype.presentEntities=function(){for(var x in this.engine.entities){var T=this.engine.entities[x];for(var R in T.components){var A=N(C=T.components[R]);if(null!==A&&!B(C)){var E=this.getJsonIfDirty(T.uuid,R,C);E&&(this.dcl.updateEntityComponent(T.uuid,R,A,E),this.clearDirty(T.uuid,R,C,E))}}}for(var S in this.engine.disposableComponents){var C;(C=this.engine.disposableComponents[S])instanceof G&&C.dirty&&(this.dcl.componentUpdated(S,JSON.stringify(C)),C.dirty=!1)}},t.prototype.componentAdded=function(x){if(x.entity.isAddedToEngine()){var T=x.entity.components[x.componentName];if(B(T))this.dcl.attachEntityComponent(x.entity.uuid,x.componentName,D(T));else if(null!==x.classId){var R=JSON.stringify(T);this.dcl.updateEntityComponent(x.entity.uuid,x.componentName,x.classId,R),this.cachedComponents[x.entity.uuid][x.componentName]=R}}},t.prototype.componentRemoved=function(x){x.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(x.entity.uuid,x.componentName),delete this.cachedComponents[x.entity.uuid][x.componentName])},t.prototype.disposableComponentCreated=function(x){this.dcl.componentCreated(x.componentId,x.componentName,x.classId)},t.prototype.disposableComponentRemoved=function(x){this.dcl.componentDisposed(x.componentId)},t.prototype.disposableComponentUpdated=function(x){this.dcl.componentUpdated(x.componentId,JSON.stringify(x.component))},t.prototype.parentChanged=function(x){this.dcl.setParent(x.entity.uuid,x.parent?x.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(x,T,R){var A=JSON.stringify(R);return A!==this.cachedComponents[x][T]&&A},t.prototype.clearDirty=function(x,T,R,A){this.cachedComponents[x][T]=A},t}();x.Orientation=void 0,(vt=x.Orientation||(x.Orientation={}))[vt.CW=0]="CW",vt[vt.CCW=1]="CCW",x.Space=void 0,(mt=x.Space||(x.Space={}))[mt.LOCAL=0]="LOCAL",mt[mt.WORLD=1]="WORLD",mt[mt.BONE=2]="BONE";var wt,_t,xt,Tt,bt=1/2.2,Rt=2.2,At=1e-6,Et=Math.PI/180,St=360/(2*Math.PI),Ct=function(){function t(){}return t.WithinEpsilon=function(x,T,R){void 0===R&&(R=1401298e-51);var A=x-T;return-R<=A&&A<=R},t.ToHex=function(x){var T=x.toString(16);return x<=15?("0"+T).toUpperCase():T.toUpperCase()},t.Sign=function(x){var T=+x;return 0===T||isNaN(T)?T:T>0?1:-1},t.Clamp=function(x,T,R){return void 0===T&&(T=0),void 0===R&&(R=1),Math.min(R,Math.max(T,x))},t.Log2=function(x){return Math.log(x)*Math.LOG2E},t.Repeat=function(x,T){return x-Math.floor(x/T)*T},t.Normalize=function(x,T,R){return(x-T)/(R-T)},t.Denormalize=function(x,T,R){return x*(R-T)+T},t.DeltaAngle=function(x,T){var R=t.Repeat(T-x,360);return R>180&&(R-=360),R},t.PingPong=function(x,T){var R=t.Repeat(x,2*T);return T-Math.abs(R-T)},t.SmoothStep=function(x,T,R){var A=t.Clamp(R);return T*(A=-2*A*A*A+3*A*A)+x*(1-A)},t.MoveTowards=function(x,T,R){return Math.abs(T-x)<=R?T:x+t.Sign(T-x)*R},t.MoveTowardsAngle=function(x,T,R){var A=t.DeltaAngle(x,T);return-R<A&&A<R?T:t.MoveTowards(x,x+A,R)},t.Lerp=function(x,T,R){return x+(T-x)*R},t.LerpAngle=function(x,T,R){var A=t.Repeat(T-x,360);return A>180&&(A-=360),x+A*t.Clamp(R)},t.InverseLerp=function(x,T,R){return x!==T?t.Clamp((R-x)/(T-x)):0},t.Hermite=function(x,T,R,A,E){var S=E*E,C=E*S;return x*(2*C-3*S+1)+R*(-2*C+3*S)+T*(C-2*S+E)+A*(C-S)},t.RandomRange=function(x,T){return x===T?x:Math.random()*(T-x)+x},t.RangeToPercent=function(x,T,R){return(x-T)/(R-T)},t.PercentToRange=function(x,T,R){return(R-T)*x+T},t.NormalizeRadians=function(x){return x-t.TwoPi*Math.floor((x+Math.PI)/t.TwoPi)},t.TwoPi=2*Math.PI,t}(),zt=function(){function t(x,T,R,A){this.x=x,this.y=T,this.z=R,this.w=A}return t.Add=function(x,T){return new t(x.x,x.y,x.z,x.w).addInPlace(T)},t.FromArray=function(x,T){return void 0===T&&(T=0),new t(x[T],x[T+1],x[T+2],x[T+3])},t.FromArrayToRef=function(x,T,R){R.x=x[T],R.y=x[T+1],R.z=x[T+2],R.w=x[T+3]},t.FromFloatArrayToRef=function(x,T,R){t.FromArrayToRef(x,T,R)},t.FromFloatsToRef=function(x,T,R,A,E){E.x=x,E.y=T,E.z=R,E.w=A},t.Zero=function(){return new t(0,0,0,0)},t.One=function(){return new t(1,1,1,1)},t.Normalize=function(x){var T=t.Zero();return t.NormalizeToRef(x,T),T},t.NormalizeToRef=function(x,T){T.copyFrom(x),T.normalize()},t.Minimize=function(x,T){var R=new t(x.x,x.y,x.z,x.w);return R.minimizeInPlace(T),R},t.Maximize=function(x,T){var R=new t(x.x,x.y,x.z,x.w);return R.maximizeInPlace(T),R},t.Distance=function(x,T){return Math.sqrt(t.DistanceSquared(x,T))},t.DistanceSquared=function(x,T){var R=x.x-T.x,A=x.y-T.y,E=x.z-T.z,S=x.w-T.w;return R*R+A*A+E*E+S*S},t.Center=function(x,T){var R=t.Add(x,T);return R.scaleInPlace(.5),R},t.TransformNormal=function(x,T){var R=t.Zero();return t.TransformNormalToRef(x,T,R),R},t.TransformNormalToRef=function(x,T,R){var A=T.m,E=x.x*A[0]+x.y*A[4]+x.z*A[8],S=x.x*A[1]+x.y*A[5]+x.z*A[9],C=x.x*A[2]+x.y*A[6]+x.z*A[10];R.x=E,R.y=S,R.z=C,R.w=x.w},t.TransformNormalFromFloatsToRef=function(x,T,R,A,E,S){var C=E.m;S.x=x*C[0]+T*C[4]+R*C[8],S.y=x*C[1]+T*C[5]+R*C[9],S.z=x*C[2]+T*C[6]+R*C[10],S.w=A},t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},t.prototype.getClassName=function(){return"Vector4"},t.prototype.getHashCode=function(){var x=this.x||0;return 397*(x=397*(x=397*x^(this.y||0))^(this.z||0))^(this.w||0)},t.prototype.asArray=function(){var x=new Array;return this.toArray(x,0),x},t.prototype.toArray=function(x,T){return void 0===T&&(T=0),x[T]=this.x,x[T+1]=this.y,x[T+2]=this.z,x[T+3]=this.w,this},t.prototype.addInPlace=function(x){return this.x+=x.x,this.y+=x.y,this.z+=x.z,this.w+=x.w,this},t.prototype.add=function(x){return new t(this.x+x.x,this.y+x.y,this.z+x.z,this.w+x.w)},t.prototype.addToRef=function(x,T){return T.x=this.x+x.x,T.y=this.y+x.y,T.z=this.z+x.z,T.w=this.w+x.w,this},t.prototype.subtractInPlace=function(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this.w-=x.w,this},t.prototype.subtract=function(x){return new t(this.x-x.x,this.y-x.y,this.z-x.z,this.w-x.w)},t.prototype.subtractToRef=function(x,T){return T.x=this.x-x.x,T.y=this.y-x.y,T.z=this.z-x.z,T.w=this.w-x.w,this},t.prototype.subtractFromFloats=function(x,T,R,A){return new t(this.x-x,this.y-T,this.z-R,this.w-A)},t.prototype.subtractFromFloatsToRef=function(x,T,R,A,E){return E.x=this.x-x,E.y=this.y-T,E.z=this.z-R,E.w=this.w-A,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.scaleInPlace=function(x){return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this},t.prototype.scale=function(x){return new t(this.x*x,this.y*x,this.z*x,this.w*x)},t.prototype.scaleToRef=function(x,T){return T.x=this.x*x,T.y=this.y*x,T.z=this.z*x,T.w=this.w*x,this},t.prototype.scaleAndAddToRef=function(x,T){return T.x+=this.x*x,T.y+=this.y*x,T.z+=this.z*x,T.w+=this.w*x,this},t.prototype.equals=function(x){return x&&this.x===x.x&&this.y===x.y&&this.z===x.z&&this.w===x.w},t.prototype.equalsWithEpsilon=function(x,T){return void 0===T&&(T=At),x&&Ct.WithinEpsilon(this.x,x.x,T)&&Ct.WithinEpsilon(this.y,x.y,T)&&Ct.WithinEpsilon(this.z,x.z,T)&&Ct.WithinEpsilon(this.w,x.w,T)},t.prototype.equalsToFloats=function(x,T,R,A){return this.x===x&&this.y===T&&this.z===R&&this.w===A},t.prototype.multiplyInPlace=function(x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this.w*=x.w,this},t.prototype.multiply=function(x){return new t(this.x*x.x,this.y*x.y,this.z*x.z,this.w*x.w)},t.prototype.multiplyToRef=function(x,T){return T.x=this.x*x.x,T.y=this.y*x.y,T.z=this.z*x.z,T.w=this.w*x.w,this},t.prototype.multiplyByFloats=function(x,T,R,A){return new t(this.x*x,this.y*T,this.z*R,this.w*A)},t.prototype.divide=function(x){return new t(this.x/x.x,this.y/x.y,this.z/x.z,this.w/x.w)},t.prototype.divideToRef=function(x,T){return T.x=this.x/x.x,T.y=this.y/x.y,T.z=this.z/x.z,T.w=this.w/x.w,this},t.prototype.divideInPlace=function(x){return this.divideToRef(x,this)},t.prototype.minimizeInPlace=function(x){return x.x<this.x&&(this.x=x.x),x.y<this.y&&(this.y=x.y),x.z<this.z&&(this.z=x.z),x.w<this.w&&(this.w=x.w),this},t.prototype.maximizeInPlace=function(x){return x.x>this.x&&(this.x=x.x),x.y>this.y&&(this.y=x.y),x.z>this.z&&(this.z=x.z),x.w>this.w&&(this.w=x.w),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.normalize=function(){var x=this.length();return 0===x?this:this.scaleInPlace(1/x)},t.prototype.toVector3=function(){return new Ot(this.x,this.y,this.z)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=x.w,this},t.prototype.copyFromFloats=function(x,T,R,A){return this.x=x,this.y=T,this.z=R,this.w=A,this},t.prototype.set=function(x,T,R,A){return this.copyFromFloats(x,T,R,A)},t.prototype.setAll=function(x){return this.x=this.y=this.z=this.w=x,this},t}(),Pt=function(){function t(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}return Object.defineProperty(t.prototype,"m",{get:function(){return this._m},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IdentityReadOnly",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),t.FromArray=function(x,T){void 0===T&&(T=0);var R=new t;return t.FromArrayToRef(x,T,R),R},t.FromArrayToRef=function(x,T,R){for(var A=0;A<16;A++)R._m[A]=x[A+T];R._markAsUpdated()},t.FromFloatArrayToRefScaled=function(x,T,R,A){for(var E=0;E<16;E++)A._m[E]=x[E+T]*R;A._markAsUpdated()},t.FromValuesToRef=function(x,T,R,A,E,S,C,I,z,P,O,U,H,k,V,W,G){var j=G._m;j[0]=x,j[1]=T,j[2]=R,j[3]=A,j[4]=E,j[5]=S,j[6]=C,j[7]=I,j[8]=z,j[9]=P,j[10]=O,j[11]=U,j[12]=H,j[13]=k,j[14]=V,j[15]=W,G._markAsUpdated()},t.FromValues=function(x,T,R,A,E,S,C,I,z,P,O,U,H,k,V,W){var G=new t,j=G._m;return j[0]=x,j[1]=T,j[2]=R,j[3]=A,j[4]=E,j[5]=S,j[6]=C,j[7]=I,j[8]=z,j[9]=P,j[10]=O,j[11]=U,j[12]=H,j[13]=k,j[14]=V,j[15]=W,G._markAsUpdated(),G},t.Compose=function(x,T,R){var A=new t;return t.ComposeToRef(x,T,R,A),A},t.ComposeToRef=function(x,T,R,A){t.ScalingToRef(x.x,x.y,x.z,Ft.Matrix[1]),T.toRotationMatrix(Ft.Matrix[0]),Ft.Matrix[1].multiplyToRef(Ft.Matrix[0],A),A.setTranslation(R)},t.Identity=function(){var x=t.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return x._updateIdentityStatus(!0),x},t.IdentityToRef=function(x){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,x),x._updateIdentityStatus(!0)},t.Zero=function(){var x=t.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return x._updateIdentityStatus(!1),x},t.RotationX=function(x){var T=new t;return t.RotationXToRef(x,T),T},t.Invert=function(x){var T=new t;return x.invertToRef(T),T},t.RotationXToRef=function(x,T){var R=Math.sin(x),A=Math.cos(x);t.FromValuesToRef(1,0,0,0,0,A,R,0,0,-R,A,0,0,0,0,1,T),T._updateIdentityStatus(1===A&&0===R)},t.RotationY=function(x){var T=new t;return t.RotationYToRef(x,T),T},t.RotationYToRef=function(x,T){var R=Math.sin(x),A=Math.cos(x);t.FromValuesToRef(A,0,-R,0,0,1,0,0,R,0,A,0,0,0,0,1,T),T._updateIdentityStatus(1===A&&0===R)},t.RotationZ=function(x){var T=new t;return t.RotationZToRef(x,T),T},t.RotationZToRef=function(x,T){var R=Math.sin(x),A=Math.cos(x);t.FromValuesToRef(A,R,0,0,-R,A,0,0,0,0,1,0,0,0,0,1,T),T._updateIdentityStatus(1===A&&0===R)},t.RotationAxis=function(x,T){var R=new t;return t.RotationAxisToRef(x,T,R),R},t.RotationAxisToRef=function(x,T,R){var A=Math.sin(-T),E=Math.cos(-T),S=1-E;x.normalize();var C=R._m;C[0]=x.x*x.x*S+E,C[1]=x.x*x.y*S-x.z*A,C[2]=x.x*x.z*S+x.y*A,C[3]=0,C[4]=x.y*x.x*S+x.z*A,C[5]=x.y*x.y*S+E,C[6]=x.y*x.z*S-x.x*A,C[7]=0,C[8]=x.z*x.x*S-x.y*A,C[9]=x.z*x.y*S+x.x*A,C[10]=x.z*x.z*S+E,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,R._markAsUpdated()},t.RotationYawPitchRoll=function(x,T,R){var A=new t;return t.RotationYawPitchRollToRef(x,T,R,A),A},t.RotationYawPitchRollToRef=function(x,T,R,A){Mt.RotationYawPitchRollToRef(x,T,R,Ft.Quaternion[0]),Ft.Quaternion[0].toRotationMatrix(A)},t.Scaling=function(x,T,R){var A=new t;return t.ScalingToRef(x,T,R,A),A},t.ScalingToRef=function(x,T,R,A){t.FromValuesToRef(x,0,0,0,0,T,0,0,0,0,R,0,0,0,0,1,A),A._updateIdentityStatus(1===x&&1===T&&1===R)},t.Translation=function(x,T,R){var A=new t;return t.TranslationToRef(x,T,R,A),A},t.TranslationToRef=function(x,T,R,A){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,x,T,R,1,A),A._updateIdentityStatus(0===x&&0===T&&0===R)},t.Lerp=function(x,T,R){var A=new t;return t.LerpToRef(x,T,R,A),A},t.LerpToRef=function(x,T,R,A){for(var E=0;E<16;E++)A._m[E]=x._m[E]*(1-R)+T._m[E]*R;A._markAsUpdated()},t.DecomposeLerp=function(x,T,R){var A=new t;return t.DecomposeLerpToRef(x,T,R,A),A},t.DecomposeLerpToRef=function(x,T,R,A){var E=Ft.Vector3[0],S=Ft.Quaternion[0],C=Ft.Vector3[1];x.decompose(E,S,C);var I=Ft.Vector3[2],z=Ft.Quaternion[1],P=Ft.Vector3[3];T.decompose(I,z,P);var O=Ft.Vector3[4];Ot.LerpToRef(E,I,R,O);var U=Ft.Quaternion[2];Mt.SlerpToRef(S,z,R,U);var H=Ft.Vector3[5];Ot.LerpToRef(C,P,R,H),t.ComposeToRef(O,U,H,A)},t.LookAtLH=function(x,T,R){var A=new t;return t.LookAtLHToRef(x,T,R,A),A},t.LookAtLHToRef=function(x,T,R,A){var E=Ft.Vector3[0],S=Ft.Vector3[1],C=Ft.Vector3[2];T.subtractToRef(x,C),C.normalize(),Ot.CrossToRef(R,C,E);var I=E.lengthSquared();0===I?E.x=1:E.normalizeFromLength(Math.sqrt(I)),Ot.CrossToRef(C,E,S),S.normalize();var z=-Ot.Dot(E,x),P=-Ot.Dot(S,x),O=-Ot.Dot(C,x);t.FromValuesToRef(E.x,S.x,C.x,0,E.y,S.y,C.y,0,E.z,S.z,C.z,0,z,P,O,1,A)},t.LookAtRH=function(x,T,R){var A=new t;return t.LookAtRHToRef(x,T,R,A),A},t.LookAtRHToRef=function(x,T,R,A){var E=Ft.Vector3[0],S=Ft.Vector3[1],C=Ft.Vector3[2];x.subtractToRef(T,C),C.normalize(),Ot.CrossToRef(R,C,E);var I=E.lengthSquared();0===I?E.x=1:E.normalizeFromLength(Math.sqrt(I)),Ot.CrossToRef(C,E,S),S.normalize();var z=-Ot.Dot(E,x),P=-Ot.Dot(S,x),O=-Ot.Dot(C,x);t.FromValuesToRef(E.x,S.x,C.x,0,E.y,S.y,C.y,0,E.z,S.z,C.z,0,z,P,O,1,A)},t.OrthoLH=function(x,T,R,A){var E=new t;return t.OrthoLHToRef(x,T,R,A,E),E},t.OrthoLHToRef=function(x,T,R,A,E){var S=2/x,C=2/T,I=2/(A-R),z=-(A+R)/(A-R);t.FromValuesToRef(S,0,0,0,0,C,0,0,0,0,I,0,0,0,z,1,E),E._updateIdentityStatus(1===S&&1===C&&1===I&&0===z)},t.OrthoOffCenterLH=function(x,T,R,A,E,S){var C=new t;return t.OrthoOffCenterLHToRef(x,T,R,A,E,S,C),C},t.OrthoOffCenterLHToRef=function(x,T,R,A,E,S,C){var I=2/(T-x),z=2/(A-R),P=2/(S-E),O=-(S+E)/(S-E),U=(x+T)/(x-T),H=(A+R)/(R-A);t.FromValuesToRef(I,0,0,0,0,z,0,0,0,0,P,0,U,H,O,1,C),C._markAsUpdated()},t.OrthoOffCenterRH=function(x,T,R,A,E,S){var C=new t;return t.OrthoOffCenterRHToRef(x,T,R,A,E,S,C),C},t.OrthoOffCenterRHToRef=function(x,T,R,A,E,S,C){t.OrthoOffCenterLHToRef(x,T,R,A,E,S,C),C._m[10]*=-1},t.PerspectiveLH=function(x,T,R,A){var E=new t,S=2*R/x,C=2*R/T,I=(A+R)/(A-R),z=-2*A*R/(A-R);return t.FromValuesToRef(S,0,0,0,0,C,0,0,0,0,I,1,0,0,z,0,E),E._updateIdentityStatus(!1),E},t.PerspectiveFovLH=function(x,T,R,A){var E=new t;return t.PerspectiveFovLHToRef(x,T,R,A,E),E},t.PerspectiveFovLHToRef=function(x,T,R,A,E,S){void 0===S&&(S=!0);var C=R,I=A,z=1/Math.tan(.5*x),P=S?z/T:z,O=S?z:z*T,U=(I+C)/(I-C),H=-2*I*C/(I-C);t.FromValuesToRef(P,0,0,0,0,O,0,0,0,0,U,1,0,0,H,0,E),E._updateIdentityStatus(!1)},t.PerspectiveFovRH=function(x,T,R,A){var E=new t;return t.PerspectiveFovRHToRef(x,T,R,A,E),E},t.PerspectiveFovRHToRef=function(x,T,R,A,E,S){void 0===S&&(S=!0);var C=R,I=A,z=1/Math.tan(.5*x),P=S?z/T:z,O=S?z:z*T,U=-(I+C)/(I-C),H=-2*I*C/(I-C);t.FromValuesToRef(P,0,0,0,0,O,0,0,0,0,U,-1,0,0,H,0,E),E._updateIdentityStatus(!1)},t.PerspectiveFovWebVRToRef=function(x,T,R,A,E){void 0===E&&(E=!1);var S=E?-1:1,C=Math.tan(x.upDegrees*Math.PI/180),I=Math.tan(x.downDegrees*Math.PI/180),z=Math.tan(x.leftDegrees*Math.PI/180),P=Math.tan(x.rightDegrees*Math.PI/180),O=2/(z+P),U=2/(C+I),H=A._m;H[0]=O,H[1]=H[2]=H[3]=H[4]=0,H[5]=U,H[6]=H[7]=0,H[8]=(z-P)*O*.5,H[9]=-(C-I)*U*.5,H[10]=-R/(T-R),H[11]=1*S,H[12]=H[13]=H[15]=0,H[14]=-2*R*T/(R-T),A._markAsUpdated()},t.GetAsMatrix2x2=function(x){return[x._m[0],x._m[1],x._m[4],x._m[5]]},t.GetAsMatrix3x3=function(x){return[x._m[0],x._m[1],x._m[2],x._m[4],x._m[5],x._m[6],x._m[8],x._m[9],x._m[10]]},t.Transpose=function(x){var T=new t;return t.TransposeToRef(x,T),T},t.TransposeToRef=function(x,T){var R=T._m,A=x._m;R[0]=A[0],R[1]=A[4],R[2]=A[8],R[3]=A[12],R[4]=A[1],R[5]=A[5],R[6]=A[9],R[7]=A[13],R[8]=A[2],R[9]=A[6],R[10]=A[10],R[11]=A[14],R[12]=A[3],R[13]=A[7],R[14]=A[11],R[15]=A[15],T._updateIdentityStatus(x._isIdentity,x._isIdentityDirty)},t.Reflection=function(x){var T=new t;return t.ReflectionToRef(x,T),T},t.ReflectionToRef=function(x,T){x.normalize();var R=x.normal.x,A=x.normal.y,E=x.normal.z,S=-2*R,C=-2*A,I=-2*E;t.FromValuesToRef(S*R+1,C*R,I*R,0,S*A,C*A+1,I*A,0,S*E,C*E,I*E+1,0,S*x.d,C*x.d,I*x.d,1,T)},t.FromXYZAxesToRef=function(x,T,R,A){t.FromValuesToRef(x.x,x.y,x.z,0,T.x,T.y,T.z,0,R.x,R.y,R.z,0,0,0,0,1,A)},t.FromQuaternionToRef=function(x,T){var R=x.x*x.x,A=x.y*x.y,E=x.z*x.z,S=x.x*x.y,C=x.z*x.w,I=x.z*x.x,z=x.y*x.w,P=x.y*x.z,O=x.x*x.w;T._m[0]=1-2*(A+E),T._m[1]=2*(S+C),T._m[2]=2*(I-z),T._m[3]=0,T._m[4]=2*(S-C),T._m[5]=1-2*(E+R),T._m[6]=2*(P+O),T._m[7]=0,T._m[8]=2*(I+z),T._m[9]=2*(P-O),T._m[10]=1-2*(A+R),T._m[11]=0,T._m[12]=0,T._m[13]=0,T._m[14]=0,T._m[15]=1,T._markAsUpdated()},t.prototype._markAsUpdated=function(){this.updateFlag=t._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},t.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var x=this._m;this._isIdentity=1===x[0]&&0===x[1]&&0===x[2]&&0===x[3]&&0===x[4]&&1===x[5]&&0===x[6]&&0===x[7]&&0===x[8]&&0===x[9]&&1===x[10]&&0===x[11]&&0===x[12]&&0===x[13]&&0===x[14]&&1===x[15]}return this._isIdentity},t.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},t.prototype.determinant=function(){if(!0===this._isIdentity)return 1;var x=this._m,T=x[0],R=x[1],A=x[2],E=x[3],S=x[4],C=x[5],I=x[6],z=x[7],P=x[8],O=x[9],U=x[10],H=x[11],k=x[12],V=x[13],W=x[14],G=x[15],j=U*G-W*H,X=O*G-V*H,Z=O*W-V*U,J=P*G-k*H,Q=P*W-U*k,K=P*V-k*O;return T*+(C*j-I*X+z*Z)+R*-(S*j-I*J+z*Q)+A*+(S*X-C*J+z*K)+E*-(S*Z-C*Q+I*K)},t.prototype.toArray=function(){return this._m},t.prototype.asArray=function(){return this._m},t.prototype.invert=function(){return this.invertToRef(this),this},t.prototype.reset=function(){return t.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},t.prototype.add=function(x){var T=new t;return this.addToRef(x,T),T},t.prototype.addToRef=function(x,T){for(var R=0;R<16;R++)T._m[R]=this._m[R]+x._m[R];return T._markAsUpdated(),this},t.prototype.addToSelf=function(x){for(var T=0;T<16;T++)this._m[T]+=x._m[T];return this._markAsUpdated(),this},t.prototype.invertToRef=function(x){if(!0===this._isIdentity)return t.IdentityToRef(x),this;var T=this._m,R=T[0],A=T[1],E=T[2],S=T[3],C=T[4],I=T[5],z=T[6],P=T[7],O=T[8],U=T[9],H=T[10],k=T[11],V=T[12],W=T[13],G=T[14],j=T[15],X=H*j-G*k,Z=U*j-W*k,J=U*G-W*H,Q=O*j-V*k,K=O*G-H*V,$=O*W-V*U,et=+(I*X-z*Z+P*J),nt=-(C*X-z*Q+P*K),ot=+(C*Z-I*Q+P*$),it=-(C*J-I*K+z*$),rt=R*et+A*nt+E*ot+S*it;if(0===rt)return x.copyFrom(this),this;var st=1/rt,at=z*j-G*P,ut=I*j-W*P,pt=I*G-W*z,lt=C*j-V*P,dt=C*G-V*z,ct=C*W-V*I,ft=z*k-H*P,yt=I*k-U*P,vt=I*H-U*z,mt=C*k-O*P,gt=C*H-O*z,wt=C*U-O*I,_t=-(A*X-E*Z+S*J),xt=+(R*X-E*Q+S*K),Tt=-(R*Z-A*Q+S*$),bt=+(R*J-A*K+E*$),Rt=+(A*at-E*ut+S*pt),At=-(R*at-E*lt+S*dt),Et=+(R*ut-A*lt+S*ct),St=-(R*pt-A*dt+E*ct),Ct=-(A*ft-E*yt+S*vt),zt=+(R*ft-E*mt+S*gt),Pt=-(R*yt-A*mt+S*wt),Mt=+(R*vt-A*gt+E*wt);return t.FromValuesToRef(et*st,_t*st,Rt*st,Ct*st,nt*st,xt*st,At*st,zt*st,ot*st,Tt*st,Et*st,Pt*st,it*st,bt*st,St*st,Mt*st,x),this},t.prototype.addAtIndex=function(x,T){return this._m[x]+=T,this._markAsUpdated(),this},t.prototype.multiplyAtIndex=function(x,T){return this._m[x]*=T,this._markAsUpdated(),this},t.prototype.setTranslationFromFloats=function(x,T,R){return this._m[12]=x,this._m[13]=T,this._m[14]=R,this._markAsUpdated(),this},t.prototype.setTranslation=function(x){return this.setTranslationFromFloats(x.x,x.y,x.z)},t.prototype.getTranslation=function(){return new Ot(this._m[12],this._m[13],this._m[14])},t.prototype.getTranslationToRef=function(x){return x.x=this._m[12],x.y=this._m[13],x.z=this._m[14],this},t.prototype.removeRotationAndScaling=function(){var x=this.m;return t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,x[12],x[13],x[14],x[15],this),this._updateIdentityStatus(0===x[12]&&0===x[13]&&0===x[14]&&1===x[15]),this},t.prototype.multiply=function(x){var T=new t;return this.multiplyToRef(x,T),T},t.prototype.copyFrom=function(x){x.copyToArray(this._m);var T=x;return this._updateIdentityStatus(T._isIdentity,T._isIdentityDirty,T._isIdentity3x2,T._isIdentity3x2Dirty),this},t.prototype.copyToArray=function(x,T){void 0===T&&(T=0);for(var R=0;R<16;R++)x[T+R]=this._m[R];return this},t.prototype.multiplyToRef=function(x,T){return this._isIdentity?(T.copyFrom(x),this):x._isIdentity?(T.copyFrom(this),this):(this.multiplyToArray(x,T._m,0),T._markAsUpdated(),this)},t.prototype.multiplyToArray=function(x,T,R){var A=this._m,E=x.m,S=A[0],C=A[1],I=A[2],z=A[3],P=A[4],O=A[5],U=A[6],H=A[7],k=A[8],V=A[9],W=A[10],G=A[11],j=A[12],X=A[13],Z=A[14],J=A[15],Q=E[0],K=E[1],$=E[2],et=E[3],nt=E[4],ot=E[5],it=E[6],rt=E[7],st=E[8],at=E[9],ut=E[10],pt=E[11],lt=E[12],dt=E[13],ct=E[14],ft=E[15];return T[R]=S*Q+C*nt+I*st+z*lt,T[R+1]=S*K+C*ot+I*at+z*dt,T[R+2]=S*$+C*it+I*ut+z*ct,T[R+3]=S*et+C*rt+I*pt+z*ft,T[R+4]=P*Q+O*nt+U*st+H*lt,T[R+5]=P*K+O*ot+U*at+H*dt,T[R+6]=P*$+O*it+U*ut+H*ct,T[R+7]=P*et+O*rt+U*pt+H*ft,T[R+8]=k*Q+V*nt+W*st+G*lt,T[R+9]=k*K+V*ot+W*at+G*dt,T[R+10]=k*$+V*it+W*ut+G*ct,T[R+11]=k*et+V*rt+W*pt+G*ft,T[R+12]=j*Q+X*nt+Z*st+J*lt,T[R+13]=j*K+X*ot+Z*at+J*dt,T[R+14]=j*$+X*it+Z*ut+J*ct,T[R+15]=j*et+X*rt+Z*pt+J*ft,this},t.prototype.equals=function(x){var T=x;if(!T)return!1;if((this._isIdentity||T._isIdentity)&&!this._isIdentityDirty&&!T._isIdentityDirty)return this._isIdentity&&T._isIdentity;var R=this.m,A=T.m;return R[0]===A[0]&&R[1]===A[1]&&R[2]===A[2]&&R[3]===A[3]&&R[4]===A[4]&&R[5]===A[5]&&R[6]===A[6]&&R[7]===A[7]&&R[8]===A[8]&&R[9]===A[9]&&R[10]===A[10]&&R[11]===A[11]&&R[12]===A[12]&&R[13]===A[13]&&R[14]===A[14]&&R[15]===A[15]},t.prototype.clone=function(){var x=new t;return x.copyFrom(this),x},t.prototype.getClassName=function(){return"Matrix"},t.prototype.getHashCode=function(){for(var x=this._m[0]||0,T=1;T<16;T++)x=397*x^(this._m[T]||0);return x},t.prototype.decompose=function(x,T,R){if(this._isIdentity)return R&&R.setAll(0),x&&x.setAll(1),T&&T.copyFromFloats(0,0,0,1),!0;var A=this._m;R&&R.copyFromFloats(A[12],A[13],A[14]);var E=x||Ft.Vector3[0];if(E.x=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]),E.y=Math.sqrt(A[4]*A[4]+A[5]*A[5]+A[6]*A[6]),E.z=Math.sqrt(A[8]*A[8]+A[9]*A[9]+A[10]*A[10]),this.determinant()<=0&&(E.y*=-1),0===E.x||0===E.y||0===E.z)return T&&T.copyFromFloats(0,0,0,1),!1;if(T){var S=1/E.x,C=1/E.y,I=1/E.z;t.FromValuesToRef(A[0]*S,A[1]*S,A[2]*S,0,A[4]*C,A[5]*C,A[6]*C,0,A[8]*I,A[9]*I,A[10]*I,0,0,0,0,1,Ft.Matrix[0]),Mt.FromRotationMatrixToRef(Ft.Matrix[0],T)}return!0},t.prototype.getRow=function(x){if(x<0||x>3)return null;var T=4*x;return new zt(this._m[T+0],this._m[T+1],this._m[T+2],this._m[T+3])},t.prototype.setRow=function(x,T){return this.setRowFromFloats(x,T.x,T.y,T.z,T.w)},t.prototype.transpose=function(){return t.Transpose(this)},t.prototype.transposeToRef=function(x){return t.TransposeToRef(this,x),this},t.prototype.setRowFromFloats=function(x,T,R,A,E){if(x<0||x>3)return this;var S=4*x;return this._m[S+0]=T,this._m[S+1]=R,this._m[S+2]=A,this._m[S+3]=E,this._markAsUpdated(),this},t.prototype.scale=function(x){var T=new t;return this.scaleToRef(x,T),T},t.prototype.scaleToRef=function(x,T){for(var R=0;R<16;R++)T._m[R]=this._m[R]*x;return T._markAsUpdated(),this},t.prototype.scaleAndAddToRef=function(x,T){for(var R=0;R<16;R++)T._m[R]+=this._m[R]*x;return T._markAsUpdated(),this},t.prototype.toNormalMatrix=function(x){var T=Ft.Matrix[0];this.invertToRef(T),T.transposeToRef(x);var R=x._m;t.FromValuesToRef(R[0],R[1],R[2],0,R[4],R[5],R[6],0,R[8],R[9],R[10],0,0,0,0,1,x)},t.prototype.getRotationMatrix=function(){var x=new t;return this.getRotationMatrixToRef(x),x},t.prototype.getRotationMatrixToRef=function(x){var T=Ft.Vector3[0];if(!this.decompose(T))return t.IdentityToRef(x),this;var R=this._m,A=1/T.x,E=1/T.y,S=1/T.z;return t.FromValuesToRef(R[0]*A,R[1]*A,R[2]*A,0,R[4]*E,R[5]*E,R[6]*E,0,R[8]*S,R[9]*S,R[10]*S,0,0,0,0,1,x),this},t.prototype.toggleModelMatrixHandInPlace=function(){var x=this._m;x[2]*=-1,x[6]*=-1,x[8]*=-1,x[9]*=-1,x[14]*=-1,this._markAsUpdated()},t.prototype.toggleProjectionMatrixHandInPlace=function(){var x=this._m;x[8]*=-1,x[9]*=-1,x[10]*=-1,x[11]*=-1,this._markAsUpdated()},t.prototype._updateIdentityStatus=function(x,T,R,A){void 0===T&&(T=!1),void 0===R&&(R=!1),void 0===A&&(A=!0),this.updateFlag=t._updateFlagSeed++,this._isIdentity=x,this._isIdentity3x2=x||R,this._isIdentityDirty=!this._isIdentity&&T,this._isIdentity3x2Dirty=!this._isIdentity3x2&&A},t._updateFlagSeed=0,t._identityReadOnly=t.Identity(),t}(),Mt=function(){function t(x,T,R,A){void 0===x&&(x=0),void 0===T&&(T=0),void 0===R&&(R=0),void 0===A&&(A=1),this.x=x,this.y=T,this.z=R,this.w=A}return t.FromRotationMatrix=function(x){var T=new t;return t.FromRotationMatrixToRef(x,T),T},t.FromRotationMatrixToRef=function(x,T){var R,A=x.m,E=A[0],S=A[4],C=A[8],I=A[1],z=A[5],P=A[9],O=A[2],U=A[6],H=A[10],k=E+z+H;k>0?(R=.5/Math.sqrt(k+1),T.w=.25/R,T.x=(U-P)*R,T.y=(C-O)*R,T.z=(I-S)*R):E>z&&E>H?(R=2*Math.sqrt(1+E-z-H),T.w=(U-P)/R,T.x=.25*R,T.y=(S+I)/R,T.z=(C+O)/R):z>H?(R=2*Math.sqrt(1+z-E-H),T.w=(C-O)/R,T.x=(S+I)/R,T.y=.25*R,T.z=(P+U)/R):(R=2*Math.sqrt(1+H-E-z),T.w=(I-S)/R,T.x=(C+O)/R,T.y=(P+U)/R,T.z=.25*R)},t.Dot=function(x,T){return x.x*T.x+x.y*T.y+x.z*T.z+x.w*T.w},t.AreClose=function(x,T){return t.Dot(x,T)>=0},t.Zero=function(){return new t(0,0,0,0)},t.Inverse=function(x){return new t(-x.x,-x.y,-x.z,x.w)},t.IsIdentity=function(x){return x&&0===x.x&&0===x.y&&0===x.z&&1===x.w},t.RotationAxis=function(x,T){var R=T*Et;return t.RotationAxisToRef(x,R,new t)},t.RotationAxisToRef=function(x,T,R){var A=T*Et,E=Math.sin(A/2);return x.normalize(),R.w=Math.cos(A/2),R.x=x.x*E,R.y=x.y*E,R.z=x.z*E,R},t.FromArray=function(x,T){return void 0===T&&(T=0),new t(x[T],x[T+1],x[T+2],x[T+3])},t.FromEulerAnglesRef=function(x,T,R,A){return t.RotationYawPitchRollToRef(T*Et,x*Et,R*Et,A)},t.RotationYawPitchRoll=function(x,T,R){var A=new t;return t.RotationYawPitchRollToRef(x,T,R,A),A},t.RotationYawPitchRollToRef=function(x,T,R,A){var E=.5*T,S=.5*x,C=.5*R,I=Math.cos(E),z=Math.cos(S),P=Math.cos(C),O=Math.sin(E),U=Math.sin(S),H=Math.sin(C);A.x=z*O*P+U*I*H,A.y=U*I*P-z*O*H,A.z=z*I*H-U*O*P,A.w=z*I*P+U*O*H},t.RotationAlphaBetaGamma=function(x,T,R){var A=new t;return t.RotationAlphaBetaGammaToRef(x,T,R,A),A},t.RotationAlphaBetaGammaToRef=function(x,T,R,A){var E=.5*(R+x),S=.5*(R-x),C=.5*T;A.x=Math.cos(S)*Math.sin(C),A.y=Math.sin(S)*Math.sin(C),A.z=Math.sin(E)*Math.cos(C),A.w=Math.cos(E)*Math.cos(C)},t.RotationQuaternionFromAxis=function(x,T,R){var A=new t(0,0,0,0);return t.RotationQuaternionFromAxisToRef(x,T,R,A),A},t.RotationQuaternionFromAxisToRef=function(x,T,R,A){var E=Ft.Matrix[0];Pt.FromXYZAxesToRef(x.normalize(),T.normalize(),R.normalize(),E),t.FromRotationMatrixToRef(E,A)},t.Slerp=function(x,T,R){var A=t.Identity;return t.SlerpToRef(x,T,R,A),A},t.SlerpToRef=function(x,T,R,A){var E,S,C=x.x*T.x+x.y*T.y+x.z*T.z+x.w*T.w,I=!1;if(C<0&&(I=!0,C=-C),C>.999999)S=1-R,E=I?-R:R;else{var z=Math.acos(C),P=1/Math.sin(z);S=Math.sin((1-R)*z)*P,E=I?-Math.sin(R*z)*P:Math.sin(R*z)*P}A.x=S*x.x+E*T.x,A.y=S*x.y+E*T.y,A.z=S*x.z+E*T.z,A.w=S*x.w+E*T.w},t.Hermite=function(x,T,R,A,E){var S=E*E,C=E*S,I=2*C-3*S+1,z=-2*C+3*S,P=C-2*S+E,O=C-S;return new t(x.x*I+R.x*z+T.x*P+A.x*O,x.y*I+R.y*z+T.y*P+A.y*O,x.z*I+R.z*z+T.z*P+A.z*O,x.w*I+R.w*z+T.w*P+A.w*O)},Object.defineProperty(t,"Identity",{get:function(){return new t(0,0,0,1)},enumerable:!1,configurable:!0}),t.Angle=function(x,T){var R=t.Dot(x,T);return 2*Math.acos(Math.min(Math.abs(R),1))*St},t.Euler=function(x,T,R){return t.RotationYawPitchRoll(T*Et,x*Et,R*Et)},t.LookRotation=function(x,T){void 0===T&&(T=Ft.staticUp);var R=Ot.Normalize(x),A=Ot.Normalize(Ot.Cross(T,R)),E=Ot.Cross(R,A),S=A.x,C=A.y,I=A.z,z=E.x,P=E.y,O=E.z,U=R.x,H=R.y,k=R.z,V=S+P+k,W=new t;if(V>0){var G=Math.sqrt(V+1);return W.w=.5*G,G=.5/G,W.x=(O-H)*G,W.y=(U-I)*G,W.z=(C-z)*G,W}if(S>=P&&S>=k){var j=Math.sqrt(1+S-P-k),X=.5/j;return W.x=.5*j,W.y=(C+z)*X,W.z=(I+U)*X,W.w=(O-H)*X,W}if(P>k){var Z=Math.sqrt(1+P-S-k),J=.5/Z;return W.x=(z+C)*J,W.y=.5*Z,W.z=(H+O)*J,W.w=(U-I)*J,W}var Q=Math.sqrt(1+k-S-P),K=.5/Q;return W.x=(U+I)*K,W.y=(H+O)*K,W.z=.5*Q,W.w=(C-z)*K,W},t.RotateTowards=function(x,T,R){var A=t.Angle(x,T);if(0===A)return T;var E=Math.min(1,R/A);return t.Slerp(x,T,E)},t.FromToRotation=function(x,T,R){void 0===R&&(R=Ft.staticUp);var A=x.normalize(),E=T.normalize(),S=Ot.Cross(A,E),C=Math.sqrt(A.lengthSquared()*E.lengthSquared())+Ot.Dot(A,E);return S.lengthSquared()<1e-4?Math.abs(C)<1e-4?new t(R.x,R.y,R.z,0).normalized:t.Identity:new t(S.x,S.y,S.z,C).normalized},Object.defineProperty(t.prototype,"normalized",{get:function(){return this.normalize()},enumerable:!1,configurable:!0}),t.prototype.setFromToRotation=function(x,T,R){void 0===R&&(R=Ft.staticUp);var A=t.FromToRotation(x,T,R);this.x=A.x,this.y=A.y,this.z=A.z,this.w=A.w},Object.defineProperty(t.prototype,"eulerAngles",{get:function(){var x=new Ot,T=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,R=this.x*this.w-this.y*this.z;return R>.4995*T?(x.x=Math.PI/2,x.y=2*Math.atan2(this.y,this.x),x.z=0):R<-.4995*T?(x.x=-Math.PI/2,x.y=-2*Math.atan2(this.y,this.x),x.z=0):(x.x=Math.asin(2*(this.w*this.x-this.y*this.z)),x.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),x.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),x.x*=St,x.y*=St,x.z*=St,x.x=Ct.Repeat(x.x,360),x.y=Ct.Repeat(x.y,360),x.z=Ct.Repeat(x.z,360),x},set:function(x){this.setEuler(x.x,x.y,x.z)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lengthSquared",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"Quaternion"},t.prototype.getHashCode=function(){var x=this.x||0;return 397*(x=397*(x=397*x^(this.y||0))^(this.z||0))^(this.w||0)},t.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},t.prototype.equals=function(x){return x&&this.x===x.x&&this.y===x.y&&this.z===x.z&&this.w===x.w},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=x.w,this},t.prototype.copyFromFloats=function(x,T,R,A){return this.x=x,this.y=T,this.z=R,this.w=A,this},t.prototype.set=function(x,T,R,A){return this.copyFromFloats(x,T,R,A)},t.prototype.setEuler=function(x,T,R){return t.RotationYawPitchRollToRef(T*Et,x*Et,R*Et,this),this},t.prototype.add=function(x){return new t(this.x+x.x,this.y+x.y,this.z+x.z,this.w+x.w)},t.prototype.addInPlace=function(x){return this.x+=x.x,this.y+=x.y,this.z+=x.z,this.w+=x.w,this},t.prototype.subtract=function(x){return new t(this.x-x.x,this.y-x.y,this.z-x.z,this.w-x.w)},t.prototype.scale=function(x){return new t(this.x*x,this.y*x,this.z*x,this.w*x)},t.prototype.scaleToRef=function(x,T){return T.x=this.x*x,T.y=this.y*x,T.z=this.z*x,T.w=this.w*x,this},t.prototype.scaleInPlace=function(x){return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this},t.prototype.scaleAndAddToRef=function(x,T){return T.x+=this.x*x,T.y+=this.y*x,T.z+=this.z*x,T.w+=this.w*x,this},t.prototype.multiply=function(x){var T=new t(0,0,0,1);return this.multiplyToRef(x,T),T},t.prototype.multiplyToRef=function(x,T){var R=this.x*x.w+this.y*x.z-this.z*x.y+this.w*x.x,A=-this.x*x.z+this.y*x.w+this.z*x.x+this.w*x.y,E=this.x*x.y-this.y*x.x+this.z*x.w+this.w*x.z,S=-this.x*x.x-this.y*x.y-this.z*x.z+this.w*x.w;return T.copyFromFloats(R,A,E,S),this},t.prototype.multiplyInPlace=function(x){return this.multiplyToRef(x,this),this},t.prototype.conjugateToRef=function(x){return x.copyFromFloats(-this.x,-this.y,-this.z,this.w),this},t.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.conjugate=function(){return new t(-this.x,-this.y,-this.z,this.w)},t.prototype.normalize=function(){var x=1/this.length;return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this},t.prototype.angleAxis=function(x,T){if(0===T.lengthSquared())return t.Identity;var R=t.Identity,A=x*Et;A*=.5;var E=T.normalize();return E=T.scaleInPlace(Math.sin(A)),R.x=E.x,R.y=E.y,R.z=E.z,R.w=Math.cos(A),R.normalize()},t.prototype.toRotationMatrix=function(x){return Pt.FromQuaternionToRef(this,x),this},t.prototype.fromRotationMatrix=function(x){return t.FromRotationMatrixToRef(x,this),this},t}(),Ot=function(){function t(x,T,R){void 0===x&&(x=0),void 0===T&&(T=0),void 0===R&&(R=0),this.x=x,this.y=T,this.z=R}return Object.defineProperty(t.prototype,"isNonUniform",{get:function(){var x=Math.abs(this.x),T=Math.abs(this.y);if(x!==T)return!0;var R=Math.abs(this.z);return x!==R||T!==R},enumerable:!1,configurable:!0}),t.Add=function(x,T){return new t(x.x,x.y,x.z).addInPlace(T)},t.GetClipFactor=function(x,T,R,A){var E=t.Dot(x,R)-A;return E/(E-(t.Dot(T,R)-A))},t.GetAngleBetweenVectors=function(x,T,R){var A=x.normalizeToRef(Ft.Vector3[1]),E=T.normalizeToRef(Ft.Vector3[2]),S=t.Dot(A,E),C=Ft.Vector3[3];return t.CrossToRef(A,E,C),t.Dot(C,R)>0?Math.acos(S):-Math.acos(S)},t.FromArray=function(x,T){return void 0===T&&(T=0),new t(x[T],x[T+1],x[T+2])},t.FromFloatArray=function(x,T){return t.FromArray(x,T)},t.FromArrayToRef=function(x,T,R){R.x=x[T],R.y=x[T+1],R.z=x[T+2]},t.FromFloatArrayToRef=function(x,T,R){return t.FromArrayToRef(x,T,R)},t.FromFloatsToRef=function(x,T,R,A){A.copyFromFloats(x,T,R)},t.Zero=function(){return new t(0,0,0)},t.One=function(){return new t(1,1,1)},t.Up=function(){return new t(0,1,0)},t.Down=function(){return new t(0,-1,0)},t.Forward=function(){return new t(0,0,1)},t.Backward=function(){return new t(0,0,-1)},t.Right=function(){return new t(1,0,0)},t.Left=function(){return new t(-1,0,0)},t.TransformCoordinates=function(x,T){var R=t.Zero();return t.TransformCoordinatesToRef(x,T,R),R},t.TransformCoordinatesToRef=function(x,T,R){return t.TransformCoordinatesFromFloatsToRef(x.x,x.y,x.z,T,R)},t.TransformCoordinatesFromFloatsToRef=function(x,T,R,A,E){var S=A.m,C=x*S[0]+T*S[4]+R*S[8]+S[12],I=x*S[1]+T*S[5]+R*S[9]+S[13],z=x*S[2]+T*S[6]+R*S[10]+S[14],P=1/(x*S[3]+T*S[7]+R*S[11]+S[15]);E.x=C*P,E.y=I*P,E.z=z*P},t.TransformNormal=function(x,T){var R=t.Zero();return t.TransformNormalToRef(x,T,R),R},t.TransformNormalToRef=function(x,T,R){this.TransformNormalFromFloatsToRef(x.x,x.y,x.z,T,R)},t.TransformNormalFromFloatsToRef=function(x,T,R,A,E){var S=A.m;E.x=x*S[0]+T*S[4]+R*S[8],E.y=x*S[1]+T*S[5]+R*S[9],E.z=x*S[2]+T*S[6]+R*S[10]},t.CatmullRom=function(x,T,R,A,E){var S=E*E,C=E*S;return new t(.5*(2*T.x+(-x.x+R.x)*E+(2*x.x-5*T.x+4*R.x-A.x)*S+(-x.x+3*T.x-3*R.x+A.x)*C),.5*(2*T.y+(-x.y+R.y)*E+(2*x.y-5*T.y+4*R.y-A.y)*S+(-x.y+3*T.y-3*R.y+A.y)*C),.5*(2*T.z+(-x.z+R.z)*E+(2*x.z-5*T.z+4*R.z-A.z)*S+(-x.z+3*T.z-3*R.z+A.z)*C))},t.Clamp=function(x,T,R){var A=new t;return t.ClampToRef(x,T,R,A),A},t.ClampToRef=function(x,T,R,A){var E=x.x;E=(E=E>R.x?R.x:E)<T.x?T.x:E;var S=x.y;S=(S=S>R.y?R.y:S)<T.y?T.y:S;var C=x.z;C=(C=C>R.z?R.z:C)<T.z?T.z:C,A.copyFromFloats(E,S,C)},t.Hermite=function(x,T,R,A,E){var S=E*E,C=E*S,I=2*C-3*S+1,z=-2*C+3*S,P=C-2*S+E,O=C-S;return new t(x.x*I+R.x*z+T.x*P+A.x*O,x.y*I+R.y*z+T.y*P+A.y*O,x.z*I+R.z*z+T.z*P+A.z*O)},t.Lerp=function(x,T,R){var A=new t(0,0,0);return t.LerpToRef(x,T,R,A),A},t.LerpToRef=function(x,T,R,A){A.x=x.x+(T.x-x.x)*R,A.y=x.y+(T.y-x.y)*R,A.z=x.z+(T.z-x.z)*R},t.Dot=function(x,T){return x.x*T.x+x.y*T.y+x.z*T.z},t.Cross=function(x,T){var R=t.Zero();return t.CrossToRef(x,T,R),R},t.CrossToRef=function(x,T,R){var A=x.y*T.z-x.z*T.y,E=x.z*T.x-x.x*T.z,S=x.x*T.y-x.y*T.x;R.copyFromFloats(A,E,S)},t.Normalize=function(x){var T=t.Zero();return t.NormalizeToRef(x,T),T},t.NormalizeToRef=function(x,T){x.normalizeToRef(T)},t.Minimize=function(x,T){var R=new t(x.x,x.y,x.z);return R.minimizeInPlace(T),R},t.Maximize=function(x,T){var R=new t(x.x,x.y,x.z);return R.maximizeInPlace(T),R},t.Distance=function(x,T){return Math.sqrt(t.DistanceSquared(x,T))},t.DistanceSquared=function(x,T){var R=x.x-T.x,A=x.y-T.y,E=x.z-T.z;return R*R+A*A+E*E},t.Center=function(x,T){var R=t.Add(x,T);return R.scaleInPlace(.5),R},t.RotationFromAxis=function(x,T,R){var A=t.Zero();return t.RotationFromAxisToRef(x,T,R,A),A},t.RotationFromAxisToRef=function(x,T,R,A){var E=Ft.Quaternion[0];Mt.RotationQuaternionFromAxisToRef(x,T,R,E),A.copyFrom(E.eulerAngles)},t.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},t.prototype.getClassName=function(){return"Vector3"},t.prototype.getHashCode=function(){var x=this.x||0;return 397*(x=397*x^(this.y||0))^(this.z||0)},t.prototype.asArray=function(){var x=[];return this.toArray(x,0),x},t.prototype.toArray=function(x,T){return void 0===T&&(T=0),x[T]=this.x,x[T+1]=this.y,x[T+2]=this.z,this},t.prototype.toQuaternion=function(){return Mt.Identity.setEuler(this.y,this.x,this.z)},t.prototype.addInPlace=function(x){return this.addInPlaceFromFloats(x.x,x.y,x.z)},t.prototype.addInPlaceFromFloats=function(x,T,R){return this.x+=x,this.y+=T,this.z+=R,this},t.prototype.add=function(x){return new t(this.x+x.x,this.y+x.y,this.z+x.z)},t.prototype.addToRef=function(x,T){return T.copyFromFloats(this.x+x.x,this.y+x.y,this.z+x.z)},t.prototype.subtractInPlace=function(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this},t.prototype.subtract=function(x){return new t(this.x-x.x,this.y-x.y,this.z-x.z)},t.prototype.subtractToRef=function(x,T){return this.subtractFromFloatsToRef(x.x,x.y,x.z,T)},t.prototype.subtractFromFloats=function(x,T,R){return new t(this.x-x,this.y-T,this.z-R)},t.prototype.subtractFromFloatsToRef=function(x,T,R,A){return A.copyFromFloats(this.x-x,this.y-T,this.z-R)},t.prototype.applyMatrix4=function(x){this.applyMatrix4ToRef(x,this)},t.prototype.applyMatrix4ToRef=function(x,T){var R=this,A=R.x,E=R.y,S=R.z,C=x.m,I=1/(C[3]*A+C[7]*E+C[11]*S+C[15]);return T.x=(C[0]*A+C[4]*E+C[8]*S+C[12])*I,T.y=(C[1]*A+C[5]*E+C[9]*S+C[13])*I,T.z=(C[2]*A+C[6]*E+C[10]*S+C[14])*I,T},t.prototype.rotate=function(x){return this.rotateToRef(x,this)},t.prototype.rotateToRef=function(x,T){var R=this,A=R.x,E=R.y,S=R.z,C=x.x,I=x.y,z=x.z,P=x.w,O=P*A+I*S-z*E,U=P*E+z*A-C*S,H=P*S+C*E-I*A,k=-C*A-I*E-z*S;return T.x=O*P+k*-C+U*-z-H*-I,T.y=U*P+k*-I+H*-C-O*-z,T.z=H*P+k*-z+O*-I-U*-C,T},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.scaleInPlace=function(x){return this.x*=x,this.y*=x,this.z*=x,this},t.prototype.scale=function(x){return new t(this.x*x,this.y*x,this.z*x)},t.prototype.scaleToRef=function(x,T){return T.copyFromFloats(this.x*x,this.y*x,this.z*x)},t.prototype.scaleAndAddToRef=function(x,T){return T.addInPlaceFromFloats(this.x*x,this.y*x,this.z*x)},t.prototype.equals=function(x){return x&&this.x===x.x&&this.y===x.y&&this.z===x.z},t.prototype.equalsWithEpsilon=function(x,T){return void 0===T&&(T=At),x&&Ct.WithinEpsilon(this.x,x.x,T)&&Ct.WithinEpsilon(this.y,x.y,T)&&Ct.WithinEpsilon(this.z,x.z,T)},t.prototype.equalsToFloats=function(x,T,R){return this.x===x&&this.y===T&&this.z===R},t.prototype.multiplyInPlace=function(x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this},t.prototype.multiply=function(x){return this.multiplyByFloats(x.x,x.y,x.z)},t.prototype.multiplyToRef=function(x,T){return T.copyFromFloats(this.x*x.x,this.y*x.y,this.z*x.z)},t.prototype.multiplyByFloats=function(x,T,R){return new t(this.x*x,this.y*T,this.z*R)},t.prototype.divide=function(x){return new t(this.x/x.x,this.y/x.y,this.z/x.z)},t.prototype.divideToRef=function(x,T){return T.copyFromFloats(this.x/x.x,this.y/x.y,this.z/x.z)},t.prototype.divideInPlace=function(x){return this.divideToRef(x,this)},t.prototype.minimizeInPlace=function(x){return this.minimizeInPlaceFromFloats(x.x,x.y,x.z)},t.prototype.maximizeInPlace=function(x){return this.maximizeInPlaceFromFloats(x.x,x.y,x.z)},t.prototype.minimizeInPlaceFromFloats=function(x,T,R){return x<this.x&&(this.x=x),T<this.y&&(this.y=T),R<this.z&&(this.z=R),this},t.prototype.maximizeInPlaceFromFloats=function(x,T,R){return x>this.x&&(this.x=x),T>this.y&&(this.y=T),R>this.z&&(this.z=R),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.normalize=function(){return this.normalizeFromLength(this.length())},t.prototype.normalizeFromLength=function(x){return 0===x||1===x?this:this.scaleInPlace(1/x)},t.prototype.normalizeToNew=function(){var x=new t(0,0,0);return this.normalizeToRef(x),x},t.prototype.normalizeToRef=function(x){var T=this.length();return 0===T||1===T?x.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/T,x)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.copyFrom=function(x){return this.copyFromFloats(x.x,x.y,x.z)},t.prototype.copyFromFloats=function(x,T,R){return this.x=x,this.y=T,this.z=R,this},t.prototype.set=function(x,T,R){return this.copyFromFloats(x,T,R)},t.prototype.setAll=function(x){return this.x=this.y=this.z=x,this},t}(),Ft={Vector3:v(6,Ot.Zero),Matrix:v(2,Pt.Identity),Quaternion:v(3,Mt.Zero),staticUp:Ot.Up(),tmpMatrix:Pt.Zero()},Lt=function(){function t(x){this._radians=x,this._radians<0&&(this._radians+=2*Math.PI)}return t.BetweenTwoPoints=function(x,T){var R=T.subtract(x);return new t(Math.atan2(R.y,R.x))},t.FromRadians=function(x){return new t(x)},t.FromDegrees=function(x){return new t(x*Math.PI/180)},t.prototype.degrees=function(){return 180*this._radians/Math.PI},t.prototype.radians=function(){return this._radians},t}(),Nt=function(){function t(x,T){void 0===x&&(x=0),void 0===T&&(T=0),this.x=x,this.y=T}return t.Zero=function(){return new t(0,0)},t.One=function(){return new t(1,1)},t.Add=function(x,T){return new t(x.x,x.y).addInPlace(T)},t.FromArray=function(x,T){return void 0===T&&(T=0),new t(x[T],x[T+1])},t.FromArrayToRef=function(x,T,R){R.x=x[T],R.y=x[T+1]},t.CatmullRom=function(x,T,R,A,E){var S=E*E,C=E*S;return new t(.5*(2*T.x+(-x.x+R.x)*E+(2*x.x-5*T.x+4*R.x-A.x)*S+(-x.x+3*T.x-3*R.x+A.x)*C),.5*(2*T.y+(-x.y+R.y)*E+(2*x.y-5*T.y+4*R.y-A.y)*S+(-x.y+3*T.y-3*R.y+A.y)*C))},t.Clamp=function(x,T,R){var A=x.x;A=(A=A>R.x?R.x:A)<T.x?T.x:A;var E=x.y;return new t(A,E=(E=E>R.y?R.y:E)<T.y?T.y:E)},t.Hermite=function(x,T,R,A,E){var S=E*E,C=E*S,I=2*C-3*S+1,z=-2*C+3*S,P=C-2*S+E,O=C-S;return new t(x.x*I+R.x*z+T.x*P+A.x*O,x.y*I+R.y*z+T.y*P+A.y*O)},t.Lerp=function(x,T,R){return new t(x.x+(T.x-x.x)*R,x.y+(T.y-x.y)*R)},t.Dot=function(x,T){return x.x*T.x+x.y*T.y},t.Normalize=function(x){var T=new t(x.x,x.y);return T.normalize(),T},t.Minimize=function(x,T){return new t(x.x<T.x?x.x:T.x,x.y<T.y?x.y:T.y)},t.Maximize=function(x,T){return new t(x.x>T.x?x.x:T.x,x.y>T.y?x.y:T.y)},t.Transform=function(x,T){var R=t.Zero();return t.TransformToRef(x,T,R),R},t.TransformToRef=function(x,T,R){var A=T.m,E=x.x*A[0]+x.y*A[4]+A[12],S=x.x*A[1]+x.y*A[5]+A[13];R.x=E,R.y=S},t.PointInTriangle=function(x,T,R,A){var E=.5*(-R.y*A.x+T.y*(-R.x+A.x)+T.x*(R.y-A.y)+R.x*A.y),S=E<0?-1:1,C=(T.y*A.x-T.x*A.y+(A.y-T.y)*x.x+(T.x-A.x)*x.y)*S,I=(T.x*R.y-T.y*R.x+(T.y-R.y)*x.x+(R.x-T.x)*x.y)*S;return C>0&&I>0&&C+I<2*E*S},t.Distance=function(x,T){return Math.sqrt(t.DistanceSquared(x,T))},t.DistanceSquared=function(x,T){var R=x.x-T.x,A=x.y-T.y;return R*R+A*A},t.Center=function(x,T){var R=t.Add(x,T);return R.scaleInPlace(.5),R},t.DistanceOfPointFromSegment=function(x,T,R){var A=t.DistanceSquared(T,R);if(0===A)return t.Distance(x,T);var E=R.subtract(T),S=Math.max(0,Math.min(1,t.Dot(x.subtract(T),E)/A)),C=T.add(E.multiplyByFloats(S,S));return t.Distance(x,C)},t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},t.prototype.getClassName=function(){return"Vector2"},t.prototype.getHashCode=function(){return 397*(this.x||0)^(this.y||0)},t.prototype.toArray=function(x,T){return void 0===T&&(T=0),x[T]=this.x,x[T+1]=this.y,this},t.prototype.asArray=function(){var x=new Array;return this.toArray(x,0),x},t.prototype.copyFrom=function(x){return this.x=x.x,this.y=x.y,this},t.prototype.copyFromFloats=function(x,T){return this.x=x,this.y=T,this},t.prototype.set=function(x,T){return this.copyFromFloats(x,T)},t.prototype.add=function(x){return new t(this.x+x.x,this.y+x.y)},t.prototype.addToRef=function(x,T){return T.x=this.x+x.x,T.y=this.y+x.y,this},t.prototype.addInPlace=function(x){return this.x+=x.x,this.y+=x.y,this},t.prototype.addVector3=function(x){return new t(this.x+x.x,this.y+x.y)},t.prototype.subtract=function(x){return new t(this.x-x.x,this.y-x.y)},t.prototype.subtractToRef=function(x,T){return T.x=this.x-x.x,T.y=this.y-x.y,this},t.prototype.subtractInPlace=function(x){return this.x-=x.x,this.y-=x.y,this},t.prototype.multiplyInPlace=function(x){return this.x*=x.x,this.y*=x.y,this},t.prototype.multiply=function(x){return new t(this.x*x.x,this.y*x.y)},t.prototype.multiplyToRef=function(x,T){return T.x=this.x*x.x,T.y=this.y*x.y,this},t.prototype.multiplyByFloats=function(x,T){return new t(this.x*x,this.y*T)},t.prototype.divide=function(x){return new t(this.x/x.x,this.y/x.y)},t.prototype.divideToRef=function(x,T){return T.x=this.x/x.x,T.y=this.y/x.y,this},t.prototype.divideInPlace=function(x){return this.divideToRef(x,this)},t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.scaleInPlace=function(x){return this.x*=x,this.y*=x,this},t.prototype.scale=function(x){var T=new t(0,0);return this.scaleToRef(x,T),T},t.prototype.scaleToRef=function(x,T){return T.x=this.x*x,T.y=this.y*x,this},t.prototype.scaleAndAddToRef=function(x,T){return T.x+=this.x*x,T.y+=this.y*x,this},t.prototype.equals=function(x){return x&&this.x===x.x&&this.y===x.y},t.prototype.equalsWithEpsilon=function(x,T){return void 0===T&&(T=At),x&&Ct.WithinEpsilon(this.x,x.x,T)&&Ct.WithinEpsilon(this.y,x.y,T)},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var x=this.length();if(0===x)return this;var T=1/x;return this.x*=T,this.y*=T,this},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),It=function(T,R,A){this.startPoint=T,this.midPoint=R,this.endPoint=A;var E=Math.pow(R.x,2)+Math.pow(R.y,2),S=(Math.pow(T.x,2)+Math.pow(T.y,2)-E)/2,C=(E-Math.pow(A.x,2)-Math.pow(A.y,2))/2,I=(T.x-R.x)*(R.y-A.y)-(R.x-A.x)*(T.y-R.y);this.centerPoint=new Nt((S*(R.y-A.y)-C*(T.y-R.y))/I,((T.x-R.x)*C-(R.x-A.x)*S)/I),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=Lt.BetweenTwoPoints(this.centerPoint,this.startPoint);var z=this.startAngle.degrees(),P=Lt.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),O=Lt.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();P-z>180&&(P-=360),P-z<-180&&(P+=360),O-P>180&&(O-=360),O-P<-180&&(O+=360),this.orientation=P-z<0?x.Orientation.CW:x.Orientation.CCW,this.angle=Lt.FromDegrees(this.orientation===x.Orientation.CW?z-O:O-z)},Dt=function(){function t(){}return t.X=new Ot(1,0,0),t.Y=new Ot(0,1,0),t.Z=new Ot(0,0,1),t}(),Ut=function(){function t(){}return t.Interpolate=function(x,T,R,A,E){for(var S=1-3*A+3*T,C=3*A-6*T,I=3*T,z=x,P=0;P<5;P++){var O=z*z;z-=1/(3*S*O+2*C*z+I)*(S*(O*z)+C*O+I*z-x),z=Math.min(1,Math.max(0,z))}return 3*Math.pow(1-z,2)*z*R+3*(1-z)*Math.pow(z,2)*E+Math.pow(z,3)},t}(),Bt=function(){function t(x,T,R,A){void 0===x&&(x=0),void 0===T&&(T=0),void 0===R&&(R=0),void 0===A&&(A=1),this.r=x,this.g=T,this.b=R,this.a=A}return t.FromHexString=function(x){if("#"!==x.substring(0,1)||9!==x.length)return new t(0,0,0,0);var T=parseInt(x.substring(1,3),16),R=parseInt(x.substring(3,5),16),A=parseInt(x.substring(5,7),16),E=parseInt(x.substring(7,9),16);return t.FromInts(T,R,A,E)},t.Lerp=function(x,T,R){var A=new t(0,0,0,0);return t.LerpToRef(x,T,R,A),A},t.LerpToRef=function(x,T,R,A){A.r=x.r+(T.r-x.r)*R,A.g=x.g+(T.g-x.g)*R,A.b=x.b+(T.b-x.b)*R,A.a=x.a+(T.a-x.a)*R},t.Red=function(){return new t(1,0,0,1)},t.Green=function(){return new t(0,1,0,1)},t.Blue=function(){return new t(0,0,1,1)},t.Black=function(){return new t(0,0,0,1)},t.White=function(){return new t(1,1,1,1)},t.Purple=function(){return new t(.5,0,.5,1)},t.Magenta=function(){return new t(1,0,1,1)},t.Yellow=function(){return new t(1,1,0,1)},t.Gray=function(){return new t(.5,.5,.5,1)},t.Teal=function(){return new t(0,1,1,1)},t.Clear=function(){return new t(0,0,0,0)},t.FromColor3=function(x,T){return void 0===T&&(T=1),new t(x.r,x.g,x.b,T)},t.FromArray=function(x,T){return void 0===T&&(T=0),new t(x[T],x[T+1],x[T+2],x[T+3])},t.FromInts=function(x,T,R,A){return new t(x/255,T/255,R/255,A/255)},t.CheckColors4=function(x,T){if(x.length===3*T){for(var R=[],A=0;A<x.length;A+=3){var E=A/3*4;R[E]=x[A],R[E+1]=x[A+1],R[E+2]=x[A+2],R[E+3]=1}return R}return x},t.prototype.addInPlace=function(x){return this.r+=x.r,this.g+=x.g,this.b+=x.b,this.a+=x.a,this},t.prototype.asArray=function(){var x=new Array;return this.toArray(x,0),x},t.prototype.toArray=function(x,T){return void 0===T&&(T=0),x[T]=this.r,x[T+1]=this.g,x[T+2]=this.b,x[T+3]=this.a,this},t.prototype.add=function(x){return new t(this.r+x.r,this.g+x.g,this.b+x.b,this.a+x.a)},t.prototype.subtract=function(x){return new t(this.r-x.r,this.g-x.g,this.b-x.b,this.a-x.a)},t.prototype.subtractToRef=function(x,T){return T.r=this.r-x.r,T.g=this.g-x.g,T.b=this.b-x.b,T.a=this.a-x.a,this},t.prototype.scale=function(x){return new t(this.r*x,this.g*x,this.b*x,this.a*x)},t.prototype.scaleToRef=function(x,T){return T.r=this.r*x,T.g=this.g*x,T.b=this.b*x,T.a=this.a*x,this},t.prototype.scaleAndAddToRef=function(x,T){return T.r+=this.r*x,T.g+=this.g*x,T.b+=this.b*x,T.a+=this.a*x,this},t.prototype.clampToRef=function(x,T,R){return void 0===x&&(x=0),void 0===T&&(T=1),R.r=Ct.Clamp(this.r,x,T),R.g=Ct.Clamp(this.g,x,T),R.b=Ct.Clamp(this.b,x,T),R.a=Ct.Clamp(this.a,x,T),this},t.prototype.multiply=function(x){return new t(this.r*x.r,this.g*x.g,this.b*x.b,this.a*x.a)},t.prototype.multiplyToRef=function(x,T){return T.r=this.r*x.r,T.g=this.g*x.g,T.b=this.b*x.b,T.a=this.a*x.a,T},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},t.prototype.getClassName=function(){return"Color4"},t.prototype.getHashCode=function(){var x=this.r||0;return 397*(x=397*(x=397*x^(this.g||0))^(this.b||0))^(this.a||0)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(x){return this.r=x.r,this.g=x.g,this.b=x.b,this.a=x.a,this},t.prototype.copyFromFloats=function(x,T,R,A){return this.r=x,this.g=T,this.b=R,this.a=A,this},t.prototype.set=function(x,T,R,A){return this.copyFromFloats(x,T,R,A)},t.prototype.toHexString=function(){var x=255*this.r|0,T=255*this.g|0,R=255*this.b|0,A=255*this.a|0;return"#"+Ct.ToHex(x)+Ct.ToHex(T)+Ct.ToHex(R)+Ct.ToHex(A)},t.prototype.toLinearSpace=function(){var x=new t;return this.toLinearSpaceToRef(x),x},t.prototype.toLinearSpaceToRef=function(x){return x.r=Math.pow(this.r,Rt),x.g=Math.pow(this.g,Rt),x.b=Math.pow(this.b,Rt),x.a=this.a,this},t.prototype.toGammaSpace=function(){var x=new t;return this.toGammaSpaceToRef(x),x},t.prototype.toGammaSpaceToRef=function(x){return x.r=Math.pow(this.r,bt),x.g=Math.pow(this.g,bt),x.b=Math.pow(this.b,bt),x.a=this.a,this},t}(),Ht=function(){function t(x,T,R){void 0===x&&(x=0),void 0===T&&(T=0),void 0===R&&(R=0),this.r=x,this.g=T,this.b=R}return t.FromHexString=function(x){if("#"!==x.substring(0,1)||7!==x.length)return new t(0,0,0);var T=parseInt(x.substring(1,3),16),R=parseInt(x.substring(3,5),16),A=parseInt(x.substring(5,7),16);return t.FromInts(T,R,A)},t.FromArray=function(x,T){return void 0===T&&(T=0),new t(x[T],x[T+1],x[T+2])},t.FromInts=function(x,T,R){return new t(x/255,T/255,R/255)},t.Lerp=function(x,T,R){var A=new t(0,0,0);return t.LerpToRef(x,T,R,A),A},t.LerpToRef=function(x,T,R,A){A.r=x.r+(T.r-x.r)*R,A.g=x.g+(T.g-x.g)*R,A.b=x.b+(T.b-x.b)*R},t.Red=function(){return new t(1,0,0)},t.Green=function(){return new t(0,1,0)},t.Blue=function(){return new t(0,0,1)},t.Black=function(){return new t(0,0,0)},t.White=function(){return new t(1,1,1)},t.Purple=function(){return new t(.5,0,.5)},t.Magenta=function(){return new t(1,0,1)},t.Yellow=function(){return new t(1,1,0)},t.Gray=function(){return new t(.5,.5,.5)},t.Teal=function(){return new t(0,1,1)},t.Random=function(){return new t(Math.random(),Math.random(),Math.random())},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},t.prototype.getClassName=function(){return"Color3"},t.prototype.getHashCode=function(){var x=this.r||0;return 397*(x=397*x^(this.g||0))^(this.b||0)},t.prototype.toArray=function(x,T){return void 0===T&&(T=0),x[T]=this.r,x[T+1]=this.g,x[T+2]=this.b,this},t.prototype.toColor4=function(x){return void 0===x&&(x=1),new Bt(this.r,this.g,this.b,x)},t.prototype.asArray=function(){var x=new Array;return this.toArray(x,0),x},t.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},t.prototype.multiply=function(x){return new t(this.r*x.r,this.g*x.g,this.b*x.b)},t.prototype.multiplyToRef=function(x,T){return T.r=this.r*x.r,T.g=this.g*x.g,T.b=this.b*x.b,this},t.prototype.equals=function(x){return x&&this.r===x.r&&this.g===x.g&&this.b===x.b},t.prototype.equalsFloats=function(x,T,R){return this.r===x&&this.g===T&&this.b===R},t.prototype.scale=function(x){return new t(this.r*x,this.g*x,this.b*x)},t.prototype.scaleToRef=function(x,T){return T.r=this.r*x,T.g=this.g*x,T.b=this.b*x,this},t.prototype.scaleAndAddToRef=function(x,T){return T.r+=this.r*x,T.g+=this.g*x,T.b+=this.b*x,this},t.prototype.clampToRef=function(x,T,R){return void 0===x&&(x=0),void 0===T&&(T=1),R.r=Ct.Clamp(this.r,x,T),R.g=Ct.Clamp(this.g,x,T),R.b=Ct.Clamp(this.b,x,T),this},t.prototype.add=function(x){return new t(this.r+x.r,this.g+x.g,this.b+x.b)},t.prototype.addToRef=function(x,T){return T.r=this.r+x.r,T.g=this.g+x.g,T.b=this.b+x.b,this},t.prototype.subtract=function(x){return new t(this.r-x.r,this.g-x.g,this.b-x.b)},t.prototype.subtractToRef=function(x,T){return T.r=this.r-x.r,T.g=this.g-x.g,T.b=this.b-x.b,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copyFrom=function(x){return this.r=x.r,this.g=x.g,this.b=x.b,this},t.prototype.copyFromFloats=function(x,T,R){return this.r=x,this.g=T,this.b=R,this},t.prototype.set=function(x,T,R){return this.copyFromFloats(x,T,R)},t.prototype.toHexString=function(){var x=255*this.r|0,T=255*this.g|0,R=255*this.b|0;return"#"+Ct.ToHex(x)+Ct.ToHex(T)+Ct.ToHex(R)},t.prototype.toLinearSpace=function(){var x=new t;return this.toLinearSpaceToRef(x),x},t.prototype.toLinearSpaceToRef=function(x){return x.r=Math.pow(this.r,Rt),x.g=Math.pow(this.g,Rt),x.b=Math.pow(this.b,Rt),this},t.prototype.toGammaSpace=function(){var x=new t;return this.toGammaSpaceToRef(x),x},t.prototype.toGammaSpaceToRef=function(x){return x.r=Math.pow(this.r,bt),x.g=Math.pow(this.g,bt),x.b=Math.pow(this.b,bt),this},t.prototype.toJSON=function(){return{r:this.r,g:this.g,b:this.b}},t}(),kt=function(){function t(x){this._length=0,this._points=x,this._length=this._computeLength(x)}return t.CreateQuadraticBezier=function(x,T,R,A){A=A>2?A:3;for(var E=new Array,s=function(x,T,R,A){return(1-x)*(1-x)*T+2*x*(1-x)*R+x*x*A},S=0;S<=A;S++)E.push(new Ot(s(S/A,x.x,T.x,R.x),s(S/A,x.y,T.y,R.y),s(S/A,x.z,T.z,R.z)));return new t(E)},t.CreateCubicBezier=function(x,T,R,A,E){E=E>3?E:4;for(var S=new Array,a=function(x,T,R,A,E){return(1-x)*(1-x)*(1-x)*T+3*x*(1-x)*(1-x)*R+3*x*x*(1-x)*A+x*x*x*E},C=0;C<=E;C++)S.push(new Ot(a(C/E,x.x,T.x,R.x,A.x),a(C/E,x.y,T.y,R.y,A.y),a(C/E,x.z,T.z,R.z,A.z)));return new t(S)},t.CreateHermiteSpline=function(x,T,R,A,E){for(var S=new Array,C=1/E,I=0;I<=E;I++)S.push(Ot.Hermite(x,T,R,A,I*C));return new t(S)},t.CreateCatmullRomSpline=function(x,T,R){var A=new Array,E=1/T,S=0;if(R){for(var C=x.length,I=0;I<C;I++){S=0;for(var z=0;z<T;z++)A.push(Ot.CatmullRom(x[I%C],x[(I+1)%C],x[(I+2)%C],x[(I+3)%C],S)),S+=E}A.push(A[0])}else{var P=new Array;for(P.push(x[0].clone()),Array.prototype.push.apply(P,x),P.push(x[x.length-1].clone()),I=0,I=0;I<P.length-3;I++)for(S=0,z=0;z<T;z++)A.push(Ot.CatmullRom(P[I],P[I+1],P[I+2],P[I+3],S)),S+=E;I--,A.push(Ot.CatmullRom(P[I],P[I+1],P[I+2],P[I+3],S))}return new t(A)},t.prototype.getPoints=function(){return this._points},t.prototype.length=function(){return this._length},t.prototype.continue=function(x){for(var T=this._points[this._points.length-1],R=this._points.slice(),A=x.getPoints(),E=1;E<A.length;E++)R.push(A[E].subtract(A[0]).add(T));return new t(R)},t.prototype._computeLength=function(x){for(var T=0,R=1;R<x.length;R++)T+=x[R].subtract(x[R-1]).length();return T},t}(),Vt=function(){function t(x,T,R,A){this.normal=new Ot(x,T,R),this.d=A}return t.FromArray=function(x){return new t(x[0],x[1],x[2],x[3])},t.FromPoints=function(x,T,R){var A=new t(0,0,0,0);return A.copyFromPoints(x,T,R),A},t.FromPositionAndNormal=function(x,T){var R=new t(0,0,0,0);return T.normalize(),R.normal=T,R.d=-(T.x*x.x+T.y*x.y+T.z*x.z),R},t.SignedDistanceToPlaneFromPositionAndNormal=function(x,T,R){var A=-(T.x*x.x+T.y*x.y+T.z*x.z);return Ot.Dot(R,T)+A},t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.getClassName=function(){return"Plane"},t.prototype.getHashCode=function(){return 397*this.normal.getHashCode()^(this.d||0)},t.prototype.normalize=function(){var x=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),T=0;return 0!==x&&(T=1/x),this.normal.x*=T,this.normal.y*=T,this.normal.z*=T,this.d*=T,this},t.prototype.transform=function(x){var T=Ft.Matrix[0];Pt.TransposeToRef(x,T);var R=T.m,A=this.normal.x,E=this.normal.y,S=this.normal.z,C=this.d;return new t(A*R[0]+E*R[1]+S*R[2]+C*R[3],A*R[4]+E*R[5]+S*R[6]+C*R[7],A*R[8]+E*R[9]+S*R[10]+C*R[11],A*R[12]+E*R[13]+S*R[14]+C*R[15])},t.prototype.dotCoordinate=function(x){return this.normal.x*x.x+this.normal.y*x.y+this.normal.z*x.z+this.d},t.prototype.copyFromPoints=function(x,T,R){var A,E=T.x-x.x,S=T.y-x.y,C=T.z-x.z,I=R.x-x.x,z=R.y-x.y,P=R.z-x.z,O=S*P-C*z,U=C*I-E*P,H=E*z-S*I,k=Math.sqrt(O*O+U*U+H*H);return A=0!==k?1/k:0,this.normal.x=O*A,this.normal.y=U*A,this.normal.z=H*A,this.d=-(this.normal.x*x.x+this.normal.y*x.y+this.normal.z*x.z),this},t.prototype.isFrontFacingTo=function(x,T){return Ot.Dot(this.normal,x)<=T},t.prototype.signedDistanceTo=function(x){return Ot.Dot(x,this.normal)+this.d},t}(),Wt=function(){function t(){}return t.GetPlanes=function(x){for(var T=[],R=0;R<6;R++)T.push(new Vt(0,0,0,0));return t.GetPlanesToRef(x,T),T},t.GetNearPlaneToRef=function(x,T){var R=x.m;T.normal.x=R[3]+R[2],T.normal.y=R[7]+R[6],T.normal.z=R[11]+R[10],T.d=R[15]+R[14],T.normalize()},t.GetFarPlaneToRef=function(x,T){var R=x.m;T.normal.x=R[3]-R[2],T.normal.y=R[7]-R[6],T.normal.z=R[11]-R[10],T.d=R[15]-R[14],T.normalize()},t.GetLeftPlaneToRef=function(x,T){var R=x.m;T.normal.x=R[3]+R[0],T.normal.y=R[7]+R[4],T.normal.z=R[11]+R[8],T.d=R[15]+R[12],T.normalize()},t.GetRightPlaneToRef=function(x,T){var R=x.m;T.normal.x=R[3]-R[0],T.normal.y=R[7]-R[4],T.normal.z=R[11]-R[8],T.d=R[15]-R[12],T.normalize()},t.GetTopPlaneToRef=function(x,T){var R=x.m;T.normal.x=R[3]-R[1],T.normal.y=R[7]-R[5],T.normal.z=R[11]-R[9],T.d=R[15]-R[13],T.normalize()},t.GetBottomPlaneToRef=function(x,T){var R=x.m;T.normal.x=R[3]+R[1],T.normal.y=R[7]+R[5],T.normal.z=R[11]+R[9],T.d=R[15]+R[13],T.normalize()},t.GetPlanesToRef=function(x,T){t.GetNearPlaneToRef(x,T[0]),t.GetFarPlaneToRef(x,T[1]),t.GetLeftPlaneToRef(x,T[2]),t.GetRightPlaneToRef(x,T[3]),t.GetTopPlaneToRef(x,T[4]),t.GetBottomPlaneToRef(x,T[5])},t}(),qt=function(){function e(x,T){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new Nt(x,T))}return e.StartingAt=function(x,T){return new e(x,T)},e.prototype.addLineTo=function(x,T){if(this.closed)return this;var R=new Nt(x,T),A=this._points[this._points.length-1];return this._points.push(R),this._length+=R.subtract(A).length(),this},e.prototype.addArcTo=function(T,R,A,E,S){if(void 0===S&&(S=36),this.closed)return this;var C=this._points[this._points.length-1],I=new Nt(T,R),z=new Nt(A,E),P=new It(C,I,z),O=P.angle.radians()/S;P.orientation===x.Orientation.CW&&(O*=-1);for(var U=P.startAngle.radians()+O,H=0;H<S;H++){var k=Math.cos(U)*P.radius+P.centerPoint.x,V=Math.sin(U)*P.radius+P.centerPoint.y;this.addLineTo(k,V),U+=O}return this},e.prototype.close=function(){return this.closed=!0,this},e.prototype.length=function(){var x=this._length;if(!this.closed){var T=this._points[this._points.length-1];x+=this._points[0].subtract(T).length()}return x},e.prototype.getPoints=function(){return this._points},e.prototype.getPointAtLengthPosition=function(x){if(x<0||x>1)return Nt.Zero();for(var T=x*this.length(),R=0,A=0;A<this._points.length;A++){var E=(A+1)%this._points.length,S=this._points[A],C=this._points[E].subtract(S),I=C.length()+R;if(T>=R&&T<=I){var z=C.normalize(),P=T-R;return new Nt(S.x+z.x*P,S.y+z.y*P)}R=I}return Nt.Zero()},e}(),Gt=function(){function t(x,T,R){void 0===T&&(T=null),this.path=x,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var A=0;A<x.length;A++)this._curve[A]=x[A].clone();this._raw=R||!1,this._compute(T)}return t.prototype.getCurve=function(){return this._curve},t.prototype.getTangents=function(){return this._tangents},t.prototype.getNormals=function(){return this._normals},t.prototype.getBinormals=function(){return this._binormals},t.prototype.getDistances=function(){return this._distances},t.prototype.update=function(x,T){void 0===T&&(T=null);for(var R=0;R<x.length;R++)this._curve[R].x=x[R].x,this._curve[R].y=x[R].y,this._curve[R].z=x[R].z;return this._compute(T),this},t.prototype._compute=function(x){var T=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[T-1]=this._curve[T-1].subtract(this._curve[T-2]),this._raw||this._tangents[T-1].normalize();var R,A,E,S,C=this._tangents[0],I=this._normalVector(this._curve[0],C,x);this._normals[0]=I,this._raw||this._normals[0].normalize(),this._binormals[0]=Ot.Cross(C,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var z=1;z<T;z++)R=this._getLastNonNullVector(z),z<T-1&&(A=this._getFirstNonNullVector(z),this._tangents[z]=R.add(A),this._tangents[z].normalize()),this._distances[z]=this._distances[z-1]+R.length(),E=this._tangents[z],S=this._binormals[z-1],this._normals[z]=Ot.Cross(S,E),this._raw||this._normals[z].normalize(),this._binormals[z]=Ot.Cross(E,this._normals[z]),this._raw||this._binormals[z].normalize()},t.prototype._getFirstNonNullVector=function(x){for(var T=1,R=this._curve[x+T].subtract(this._curve[x]);0===R.length()&&x+T+1<this._curve.length;)T++,R=this._curve[x+T].subtract(this._curve[x]);return R},t.prototype._getLastNonNullVector=function(x){for(var T=1,R=this._curve[x].subtract(this._curve[x-T]);0===R.length()&&x>T+1;)T++,R=this._curve[x].subtract(this._curve[x-T]);return R},t.prototype._normalVector=function(x,T,R){var A,E,S=T.length();(0===S&&(S=1),null==R)?(E=Ct.WithinEpsilon(Math.abs(T.y)/S,1,At)?Ct.WithinEpsilon(Math.abs(T.x)/S,1,At)?Ct.WithinEpsilon(Math.abs(T.z)/S,1,At)?Ot.Zero():new Ot(0,0,1):new Ot(1,0,0):new Ot(0,-1,0),A=Ot.Cross(T,E)):(A=Ot.Cross(T,R),Ot.CrossToRef(A,T,A));return A.normalize(),A},t}(),Yt=function(){function t(x,T){this.width=x,this.height=T}return Object.defineProperty(t.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.Zero=function(){return new t(0,0)},t.Lerp=function(x,T,R){return new t(x.width+(T.width-x.width)*R,x.height+(T.height-x.height)*R)},t.prototype.toString=function(){return"{W: "+this.width+", H: "+this.height+"}"},t.prototype.getClassName=function(){return"Size"},t.prototype.getHashCode=function(){return 397*(this.width||0)^(this.height||0)},t.prototype.copyFrom=function(x){this.width=x.width,this.height=x.height},t.prototype.copyFromFloats=function(x,T){return this.width=x,this.height=T,this},t.prototype.set=function(x,T){return this.copyFromFloats(x,T)},t.prototype.multiplyByFloats=function(x,T){return new t(this.width*x,this.height*T)},t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.equals=function(x){return!!x&&this.width===x.width&&this.height===x.height},t.prototype.add=function(x){return new t(this.width+x.width,this.height+x.height)},t.prototype.subtract=function(x){return new t(this.width-x.width,this.height-x.height)},t}(),Xt={looping:!0,speed:1,weight:1,layer:0},Jt=function(x){function e(T,R){void 0===R&&(R=Xt);var A=x.call(this)||this;return A.isAnimationClip=!0,A.looping=Xt.looping,A.weight=Xt.weight,A.playing=!1,A.shouldReset=!1,A.speed=Xt.speed,A.name=f("AnimClip"),A.layer=Xt.layer,A.clip=T,A.setParams(i({},R)),A}return o(e,x),e.prototype.setParams=function(x){return this.looping=void 0!==x.looping?x.looping:this.looping,this.speed=x.speed||this.speed,this.weight=x.weight||this.weight,this.layer=x.layer||this.layer,this},e.prototype.toJSON=function(){var T=JSON.parse(JSON.stringify(x.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),T},e.prototype.play=function(x){var T;void 0===x&&(x=!1),null===(T=this.owner)||void 0===T||T.play(this,x)},e.prototype.pause=function(){var x;null===(x=this.owner)||void 0===x||x.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var x;null===(x=this.owner)||void 0===x||x.stop(this)},r([G.readonly],e.prototype,"clip",void 0),r([G.field],e.prototype,"looping",void 0),r([G.field],e.prototype,"weight",void 0),r([G.field],e.prototype,"playing",void 0),r([G.field],e.prototype,"shouldReset",void 0),r([G.field],e.prototype,"speed",void 0),r([G.readonly],e.prototype,"name",void 0),e}(G);x.InputEventType=void 0,(wt=x.InputEventType||(x.InputEventType={}))[wt.DOWN=0]="DOWN",wt[wt.UP=1]="UP",x.CameraMode=void 0,(_t=x.CameraMode||(x.CameraMode={}))[_t.FirstPerson=0]="FirstPerson",_t[_t.ThirdPerson=1]="ThirdPerson",_t[_t.BuildingToolGodMode=2]="BuildingToolGodMode",x.LandRole=void 0,(xt=x.LandRole||(x.LandRole={})).OWNER="owner",xt.OPERATOR="operator",x.ActionButton=void 0,(Tt=x.ActionButton||(x.ActionButton={})).POINTER="POINTER",Tt.PRIMARY="PRIMARY",Tt.SECONDARY="SECONDARY",Tt.ANY="ANY";var Qt,Kt,jt=function(x){if(this.callback=x,!x||!("apply"in x)||!("call"in x))throw new Error("Callback is not a function");ee.ensureInstance()},$t=function(x){function e(){return null!==x&&x.apply(this,arguments)||this}return o(e,x),r([M("pointerDown")],e)}(jt),te=function(x){function e(){return null!==x&&x.apply(this,arguments)||this}return o(e,x),r([M("pointerUp")],e)}(jt),Zt=function(x,T){this.fn=x,this.useRaycast=T},ee=function(){function e(){var T,R;this.subscriptions=((T={})[x.ActionButton.POINTER]={BUTTON_DOWN:[],BUTTON_UP:[]},T[x.ActionButton.PRIMARY]={BUTTON_DOWN:[],BUTTON_UP:[]},T[x.ActionButton.SECONDARY]={BUTTON_DOWN:[],BUTTON_UP:[]},T[x.ActionButton.ANY]={BUTTON_DOWN:[],BUTTON_UP:[]},T),this.internalState=((R={})[x.ActionButton.POINTER]={BUTTON_DOWN:!1},R[x.ActionButton.PRIMARY]={BUTTON_DOWN:!1},R[x.ActionButton.SECONDARY]={BUTTON_DOWN:!1},R[x.ActionButton.ANY]={BUTTON_DOWN:!1},R)}return Object.defineProperty(e,"instance",{get:function(){return e.ensureInstance(),e._instance},enumerable:!1,configurable:!0}),e.ensureInstance=function(){e._instance||(e._instance=new e)},e.prototype.isButtonPressed=function(x){return this.internalState[x]},e.prototype.subscribe=function(x,T,R,A){var E=this;return this.subscriptions[T][x].push(new Zt(A,R)),function(){E.unsubscribe(x,T,A)}},e.prototype.unsubscribe=function(x,T,R){var A=this.getSubscriptionId(x,T,R);return A>-1&&this.subscriptions[T][x].splice(A,1)},e.prototype.handlePointerEvent=function(T){var R=this.getPointerById(T.buttonId),A=i(i({},T),{button:R,direction:(new Ot).copyFrom(T.direction),origin:(new Ot).copyFrom(T.origin),hit:void 0}),E=T.hit?i(i({},T.hit),{hitPoint:(new Ot).copyFrom(T.hit.hitPoint),normal:(new Ot).copyFrom(T.hit.normal),worldNormal:(new Ot).copyFrom(T.hit.worldNormal)}):void 0;if(T.type===x.InputEventType.DOWN){this.internalState[R].BUTTON_DOWN=!0;for(var S=0;S<this.subscriptions[R].BUTTON_DOWN.length;S++)(C=this.subscriptions[R].BUTTON_DOWN[S]).useRaycast?A.hit=E:A.hit=void 0,C.fn(A);E&&E.entityId&&F.engine&&(z=(I=F.engine.entities[E.entityId])&&I.getComponentOrNull($t))&&(A.hit=E,z.callback(A))}else{for(this.internalState[R].BUTTON_DOWN=!1,S=0;S<this.subscriptions[R].BUTTON_UP.length;S++){var C;(C=this.subscriptions[R].BUTTON_UP[S]).useRaycast?A.hit=E:A.hit=void 0,C.fn(A)}var I,z;E&&E.entityId&&F.engine&&(z=(I=F.engine.entities[E.entityId])&&I.getComponentOrNull(te))&&(A.hit=E,z.callback(A))}},e.prototype.getSubscriptionId=function(x,T,R){for(var A=0;A<this.subscriptions[T][x].length;A++)if(this.subscriptions[T][x][A].fn===R)return A;return-1},e.prototype.getPointerById=function(T){return 0===T?x.ActionButton.POINTER:1===T?x.ActionButton.PRIMARY:x.ActionButton.SECONDARY},e}();x.CLASS_ID=void 0,(Qt=x.CLASS_ID||(x.CLASS_ID={}))[Qt.TRANSFORM=1]="TRANSFORM",Qt[Qt.UUID_CALLBACK=8]="UUID_CALLBACK",Qt[Qt.BOX_SHAPE=16]="BOX_SHAPE",Qt[Qt.SPHERE_SHAPE=17]="SPHERE_SHAPE",Qt[Qt.PLANE_SHAPE=18]="PLANE_SHAPE",Qt[Qt.CONE_SHAPE=19]="CONE_SHAPE",Qt[Qt.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",Qt[Qt.TEXT_SHAPE=21]="TEXT_SHAPE",Qt[Qt.NFT_SHAPE=22]="NFT_SHAPE",Qt[Qt.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",Qt[Qt.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",Qt[Qt.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",Qt[Qt.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",Qt[Qt.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",Qt[Qt.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",Qt[Qt.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",Qt[Qt.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",Qt[Qt.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",Qt[Qt.BILLBOARD=32]="BILLBOARD",Qt[Qt.ANIMATION=33]="ANIMATION",Qt[Qt.FONT=34]="FONT",Qt[Qt.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",Qt[Qt.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",Qt[Qt.GLTF_SHAPE=54]="GLTF_SHAPE",Qt[Qt.OBJ_SHAPE=55]="OBJ_SHAPE",Qt[Qt.AVATAR_SHAPE=56]="AVATAR_SHAPE",Qt[Qt.BASIC_MATERIAL=64]="BASIC_MATERIAL",Qt[Qt.PBR_MATERIAL=65]="PBR_MATERIAL",Qt[Qt.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",Qt[Qt.SOUND=67]="SOUND",Qt[Qt.TEXTURE=68]="TEXTURE",Qt[Qt.VIDEO_CLIP=70]="VIDEO_CLIP",Qt[Qt.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",Qt[Qt.AUDIO_CLIP=200]="AUDIO_CLIP",Qt[Qt.AUDIO_SOURCE=201]="AUDIO_SOURCE",Qt[Qt.AUDIO_STREAM=202]="AUDIO_STREAM",Qt[Qt.GIZMOS=203]="GIZMOS",Qt[Qt.SMART_ITEM=204]="SMART_ITEM",Qt[Qt.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",Qt[Qt.NAME=300]="NAME",Qt[Qt.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",Qt[Qt.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT",x.AvatarModifiers=void 0,(Kt=x.AvatarModifiers||(x.AvatarModifiers={})).HIDE_AVATARS="HIDE_AVATARS",Kt.DISABLE_PASSPORTS="DISABLE_PASSPORTS";var ne,oe=function(T){function n(x){var R=T.call(this)||this;return R.area=x.area,R.modifiers=x.modifiers,R}return o(n,T),r([G.field],n.prototype,"area",void 0),r([G.field],n.prototype,"modifiers",void 0),r([M("engine.avatarModifierArea",x.CLASS_ID.AVATAR_MODIFIER_AREA)],n)}(G),ie=function(T){function n(x){void 0===x&&(x={});var R=T.call(this)||this;return R.position=x.position||Ot.Zero(),R.rotation=x.rotation||Mt.Identity,R.scale=x.scale||new Ot(1,1,1),R}return o(n,T),Object.defineProperty(n.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),n.prototype.lookAt=function(x,T){void 0===T&&(T=Ft.staticUp);var R=new Pt;return Pt.LookAtLHToRef(this.position,x,T,R),R.invert(),Mt.FromRotationMatrixToRef(R,this.rotation),this},n.prototype.rotate=function(x,T){return this.rotation.multiplyInPlace(this.rotation.angleAxis(T,x)),this},n.prototype.translate=function(x){return this.position.addInPlace(x),this},r([G.field],n.prototype,"position",void 0),r([G.field],n.prototype,"rotation",void 0),r([G.field],n.prototype,"scale",void 0),r([M("engine.transform",x.CLASS_ID.TRANSFORM)],n)}(G),re=function(T){function n(x,R,A){void 0===x&&(x=!0),void 0===R&&(R=!0),void 0===A&&(A=!0);var E=T.call(this)||this;return E.x=!0,E.y=!0,E.z=!0,E.x=x,E.y=R,E.z=A,E}return o(n,T),r([G.field],n.prototype,"x",void 0),r([G.field],n.prototype,"y",void 0),r([G.field],n.prototype,"z",void 0),r([M("engine.billboard",x.CLASS_ID.BILLBOARD)],n)}(G),se=function(x){function e(){var T=null!==x&&x.apply(this,arguments)||this;return T.withCollisions=!0,T.isPointerBlocker=!0,T.visible=!0,T}return o(e,x),r([G.field],e.prototype,"withCollisions",void 0),r([G.field],e.prototype,"isPointerBlocker",void 0),r([G.field],e.prototype,"visible",void 0),e}(G),ae=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return o(n,T),r([G.field],n.prototype,"uvs",void 0),r([F("engine.shape",x.CLASS_ID.BOX_SHAPE)],n)}(se),ue=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return o(n,T),r([F("engine.shape",x.CLASS_ID.SPHERE_SHAPE)],n)}(se),pe=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return o(n,T),r([G.field],n.prototype,"segments",void 0),r([G.field],n.prototype,"arc",void 0),r([F("engine.shape",x.CLASS_ID.CIRCLE_SHAPE)],n)}(se),he=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.width=1,x.height=1,x}return o(n,T),r([G.field],n.prototype,"width",void 0),r([G.field],n.prototype,"height",void 0),r([G.field],n.prototype,"uvs",void 0),r([F("engine.shape",x.CLASS_ID.PLANE_SHAPE)],n)}(se),le=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.radiusTop=0,x.radiusBottom=1,x.segmentsHeight=1,x.segmentsRadial=36,x.openEnded=!1,x.radius=null,x.arc=360,x}return o(n,T),r([G.field],n.prototype,"radiusTop",void 0),r([G.field],n.prototype,"radiusBottom",void 0),r([G.field],n.prototype,"segmentsHeight",void 0),r([G.field],n.prototype,"segmentsRadial",void 0),r([G.field],n.prototype,"openEnded",void 0),r([G.field],n.prototype,"radius",void 0),r([G.field],n.prototype,"arc",void 0),r([F("engine.shape",x.CLASS_ID.CONE_SHAPE)],n)}(se),de=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.radiusTop=1,x.radiusBottom=1,x.segmentsHeight=1,x.segmentsRadial=36,x.openEnded=!1,x.radius=null,x.arc=360,x}return o(n,T),r([G.field],n.prototype,"radiusTop",void 0),r([G.field],n.prototype,"radiusBottom",void 0),r([G.field],n.prototype,"segmentsHeight",void 0),r([G.field],n.prototype,"segmentsRadial",void 0),r([G.field],n.prototype,"openEnded",void 0),r([G.field],n.prototype,"radius",void 0),r([G.field],n.prototype,"arc",void 0),r([F("engine.shape",x.CLASS_ID.CYLINDER_SHAPE)],n)}(se),ce=function(T){function n(x){var R=T.call(this)||this;return R.src=x,R}return o(n,T),r([se.readonly],n.prototype,"src",void 0),r([F("engine.shape",x.CLASS_ID.GLTF_SHAPE)],n)}(se);x.PictureFrameStyle=void 0,(ne=x.PictureFrameStyle||(x.PictureFrameStyle={}))[ne.Classic=0]="Classic",ne[ne.Baroque_Ornament=1]="Baroque_Ornament",ne[ne.Diamond_Ornament=2]="Diamond_Ornament",ne[ne.Minimal_Wide=3]="Minimal_Wide",ne[ne.Minimal_Grey=4]="Minimal_Grey",ne[ne.Blocky=5]="Blocky",ne[ne.Gold_Edges=6]="Gold_Edges",ne[ne.Gold_Carved=7]="Gold_Carved",ne[ne.Gold_Wide=8]="Gold_Wide",ne[ne.Gold_Rounded=9]="Gold_Rounded",ne[ne.Metal_Medium=10]="Metal_Medium",ne[ne.Metal_Wide=11]="Metal_Wide",ne[ne.Metal_Slim=12]="Metal_Slim",ne[ne.Metal_Rounded=13]="Metal_Rounded",ne[ne.Pins=14]="Pins",ne[ne.Minimal_Black=15]="Minimal_Black",ne[ne.Minimal_White=16]="Minimal_White",ne[ne.Tape=17]="Tape",ne[ne.Wood_Slim=18]="Wood_Slim",ne[ne.Wood_Wide=19]="Wood_Wide",ne[ne.Wood_Twigs=20]="Wood_Twigs",ne[ne.Canvas=21]="Canvas",ne[ne.None=22]="None";var fe,ye=function(T){function n(R,A){void 0===A&&(A={});var E=T.call(this)||this;E.src=R;var S=new Ht(.6404918,.611472,.8584906),C=x.PictureFrameStyle.Classic;return"r"in A?S=A:null!=A&&(A.color&&(S=A.color),A.style&&(C=A.style)),E.color=S,E.style=C,E}return o(n,T),r([se.readonly],n.prototype,"src",void 0),r([se.readonly],n.prototype,"style",void 0),r([G.field],n.prototype,"color",void 0),r([F("engine.shape",x.CLASS_ID.NFT_SHAPE)],n)}(se),ve=function(T){function n(x,R){var A=T.call(this)||this;if(A.src=x,R)for(var E in R)A[E]=R[E];return A}return o(n,T),r([G.readonly],n.prototype,"src",void 0),r([G.readonly],n.prototype,"samplingMode",void 0),r([G.readonly],n.prototype,"wrap",void 0),r([G.readonly],n.prototype,"hasAlpha",void 0),r([F("engine.texture",x.CLASS_ID.TEXTURE)],n)}(G),me=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.states=[],x}return o(n,T),n.prototype.addClip=function(x){var T=this;return this.states.push(x),x.onChange((function(){T.dirty=!0})),x.owner=this,this},n.prototype.getClip=function(x){for(var T=0;T<this.states.length;T++){var R=this.states[T];if(R.clip===x)return R}var A=new Jt(x);return this.addClip(A),A},n.prototype.stop=function(x){if(x)x.playing=!1,x.shouldReset=!0;else for(var T=0;T<this.states.length;T++){var R=this.states[T];this.stop(R)}},n.prototype.play=function(x,T){void 0===T&&(T=!1);for(var R=0;R<this.states.length;R++){var A=this.states[R];A.layer===x.layer&&x!==A&&this.pause(A)}T&&(x.shouldReset=!0),x.playing=!0,x.dirty=!0,x.data.nonce=Math.random()},n.prototype.pause=function(x){if(x)x.playing=!1;else for(var T=0;T<this.states.length;T++){var R=this.states[T];this.pause(R)}},r([G.readonly],n.prototype,"states",void 0),r([M("engine.animator",x.CLASS_ID.ANIMATION)],n)}(se),ge=function(T){function n(x){var R=T.call(this)||this;return R.src=x,R}return o(n,T),r([G.readonly],n.prototype,"src",void 0),r([F("engine.shape",x.CLASS_ID.OBJ_SHAPE)],n)}(se),we=function(T){function n(x){void 0===x&&(x="");var R=T.call(this)||this;return R.src=x,R}return o(n,T),r([G.readonly],n.prototype,"src",void 0),r([F("engine.font",x.CLASS_ID.FONT)],n)}(G);x.Fonts=void 0,(fe=x.Fonts||(x.Fonts={})).SanFrancisco="builtin:SF-UI-Text-Regular SDF",fe.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",fe.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",fe.LiberationSans="builtin:LiberationSans SDF",fe.SansSerif="SansSerif",fe.SansSerif_Heavy="SansSerif_Heavy",fe.SansSerif_Bold="SansSerif_Bold",fe.SansSerif_SemiBold="SansSerif_SemiBold";var _e,xe=function(T){function n(x){var R=T.call(this)||this;return R.outlineWidth=0,R.outlineColor=new Ht(1,1,1),R.color=new Ht(1,1,1),R.fontSize=10,R.fontWeight="normal",R.opacity=1,R.value="",R.lineSpacing="0px",R.lineCount=0,R.resizeToFit=!1,R.textWrapping=!1,R.shadowBlur=0,R.shadowOffsetX=0,R.shadowOffsetY=0,R.shadowColor=new Ht(1,1,1),R.zIndex=0,R.hTextAlign="center",R.vTextAlign="center",R.width=1,R.height=1,R.paddingTop=0,R.paddingRight=0,R.paddingBottom=0,R.paddingLeft=0,R.isPickable=!1,R.billboard=!1,R.visible=!0,x&&(R.value=x),R}return o(n,T),r([G.field],n.prototype,"outlineWidth",void 0),r([G.field],n.prototype,"outlineColor",void 0),r([G.field],n.prototype,"color",void 0),r([G.field],n.prototype,"fontSize",void 0),r([G.field],n.prototype,"fontWeight",void 0),r([G.component],n.prototype,"font",void 0),r([G.field],n.prototype,"opacity",void 0),r([G.field],n.prototype,"value",void 0),r([G.field],n.prototype,"lineSpacing",void 0),r([G.field],n.prototype,"lineCount",void 0),r([G.field],n.prototype,"resizeToFit",void 0),r([G.field],n.prototype,"textWrapping",void 0),r([G.field],n.prototype,"shadowBlur",void 0),r([G.field],n.prototype,"shadowOffsetX",void 0),r([G.field],n.prototype,"shadowOffsetY",void 0),r([G.field],n.prototype,"shadowColor",void 0),r([G.field],n.prototype,"zIndex",void 0),r([G.field],n.prototype,"hTextAlign",void 0),r([G.field],n.prototype,"vTextAlign",void 0),r([G.field],n.prototype,"width",void 0),r([G.field],n.prototype,"height",void 0),r([G.field],n.prototype,"paddingTop",void 0),r([G.field],n.prototype,"paddingRight",void 0),r([G.field],n.prototype,"paddingBottom",void 0),r([G.field],n.prototype,"paddingLeft",void 0),r([G.field],n.prototype,"isPickable",void 0),r([G.field],n.prototype,"billboard",void 0),r([G.field],n.prototype,"visible",void 0),r([M("engine.text",x.CLASS_ID.TEXT_SHAPE)],n)}(G);x.TransparencyMode=void 0,(_e=x.TransparencyMode||(x.TransparencyMode={}))[_e.OPAQUE=0]="OPAQUE",_e[_e.ALPHA_TEST=1]="ALPHA_TEST",_e[_e.ALPHA_BLEND=2]="ALPHA_BLEND",_e[_e.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",_e[_e.AUTO=4]="AUTO";var Te,be=function(T){function n(){var R=null!==T&&T.apply(this,arguments)||this;return R.alphaTest=.5,R.castShadows=!0,R.transparencyMode=x.TransparencyMode.AUTO,R}return o(n,T),r([G.field],n.prototype,"alphaTest",void 0),r([G.field],n.prototype,"albedoColor",void 0),r([G.field],n.prototype,"emissiveColor",void 0),r([G.field],n.prototype,"metallic",void 0),r([G.field],n.prototype,"roughness",void 0),r([G.field],n.prototype,"ambientColor",void 0),r([G.field],n.prototype,"reflectionColor",void 0),r([G.field],n.prototype,"reflectivityColor",void 0),r([G.field],n.prototype,"directIntensity",void 0),r([G.field],n.prototype,"microSurface",void 0),r([G.field],n.prototype,"emissiveIntensity",void 0),r([G.field],n.prototype,"environmentIntensity",void 0),r([G.field],n.prototype,"specularIntensity",void 0),r([G.component],n.prototype,"albedoTexture",void 0),r([G.component],n.prototype,"alphaTexture",void 0),r([G.component],n.prototype,"emissiveTexture",void 0),r([G.component],n.prototype,"bumpTexture",void 0),r([G.component],n.prototype,"refractionTexture",void 0),r([G.field],n.prototype,"castShadows",void 0),r([G.field],n.prototype,"transparencyMode",void 0),r([F("engine.material",x.CLASS_ID.PBR_MATERIAL)],n)}(G),Re=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.alphaTest=.5,x.castShadows=!0,x}return o(n,T),r([G.component],n.prototype,"texture",void 0),r([G.field],n.prototype,"alphaTest",void 0),r([G.field],n.prototype,"castShadows",void 0),r([F("engine.material",x.CLASS_ID.BASIC_MATERIAL)],n)}(G),Ae=function(x){function e(T){var R=x.call(this)||this;if(R.uuid=f("UUID"),!T||!("apply"in T)||!("call"in T))throw new Error("Callback is not a function");return R.callback=T,R}return o(e,x),e.uuidEvent=function(x,T){if(delete x[T]){var R=T+"_"+Math.random();x[R]=void 0,Object.defineProperty(x,R,i(i({},Object.getOwnPropertyDescriptor(x,R)),{enumerable:!1})),Object.defineProperty(x,T.toString(),{get:function(){return this[R]},set:function(x){var A=this[R];if(x){if(!(x instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[T]=x.uuid}else this.data[T]=null;if(this[R]=x,x!==A){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](T,x,A)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},r([G.field],e.prototype,"callback",void 0),e}(G),Ee=function(T){function n(){var R=null!==T&&T.apply(this,arguments)||this;return R.button=x.ActionButton.ANY,R.hoverText="Interact",R.distance=10,R.showFeedback=!0,R}return o(n,T),n.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},r([G.field],n.prototype,"button",void 0),r([G.field],n.prototype,"hoverText",void 0),r([G.field],n.prototype,"distance",void 0),r([G.field],n.prototype,"showFeedback",void 0),n}(Ae),Se=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.type="onPointerLock",x}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onPointerLock",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),Ce=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.type="onAnimationEnd",x}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onAnimationEnd",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),Ie=function(T){function n(){return null!==T&&T.apply(this,arguments)||this}return o(n,T),r([M("engine.smartItem",x.CLASS_ID.SMART_ITEM)],n)}(G),ze=function(T){function n(x){var R=T.call(this)||this;return R.url=x,R}return o(n,T),r([G.readonly],n.prototype,"url",void 0),r([F("engine.VideoClip",x.CLASS_ID.VIDEO_CLIP)],n)}(G);x.VideoStatus=void 0,(Te=x.VideoStatus||(x.VideoStatus={}))[Te.NONE=0]="NONE",Te[Te.ERROR=1]="ERROR",Te[Te.LOADING=2]="LOADING",Te[Te.READY=3]="READY",Te[Te.PLAYING=4]="PLAYING",Te[Te.BUFFERING=5]="BUFFERING";var Pe,Me=function(T){function n(R,A){var E=T.call(this)||this;if(E.volume=1,E.playbackRate=1,E.loop=!1,E.seek=-1,E._position=-1,E._videoLength=-1,E._status=x.VideoStatus.NONE,E.playing=!1,!(R instanceof ze))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(E.videoClipId=D(R),A)for(var S in A)E[S]=A[S];return E}return o(n,T),n.prototype.play=function(){this.playing=!0},n.prototype.pause=function(){this.playing=!1},n.prototype.reset=function(){this.seekTime(0),this.pause()},n.prototype.seekTime=function(x){this.seek=x,this.dirty=!0,this.data.nonce=Math.random()},n.prototype.toJSON=function(){if(this.seek>=0){var x=JSON.parse(JSON.stringify(T.prototype.toJSON.call(this)));return this.seek=-1,x}return T.prototype.toJSON.call(this)},n.prototype.update=function(T){T.videoClipId==this.videoClipId&&(this._status=T.videoStatus||x.VideoStatus.NONE,this._videoLength=T.totalVideoLength,this._position=T.currentOffset)},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"videoLength",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),r([G.readonly],n.prototype,"videoClipId",void 0),r([G.readonly],n.prototype,"samplingMode",void 0),r([G.readonly],n.prototype,"wrap",void 0),r([G.field],n.prototype,"volume",void 0),r([G.field],n.prototype,"playbackRate",void 0),r([G.field],n.prototype,"loop",void 0),r([G.field],n.prototype,"seek",void 0),r([G.field],n.prototype,"playing",void 0),r([F("engine.VideoTexture",x.CLASS_ID.VIDEO_TEXTURE)],n)}(G),Oe=function(){function e(){var T=this;this.position=new Ot,this.rotation=new Mt,this.feetPosition=new Ot,this.worldPosition=new Ot,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=x.CameraMode.FirstPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(x){switch(x.type){case"positionChanged":T.positionChanged(x.data);break;case"rotationChanged":T.rotationChanged(x.data);break;case"cameraModeChanged":T.cameraModeChanged(x.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return T.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return T.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return T.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return T.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return T.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return T.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return T.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return T.lastEventPosition.y-T.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return T.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return T.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return T.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return T.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return T.lastEventRotation.w}})}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),e.prototype.positionChanged=function(x){this.lastEventPosition=x.position,this.lastEventWorldPosition=x.cameraPosition,this._playerHeight=x.playerHeight},e.prototype.rotationChanged=function(x){this.lastEventRotation=x.quaternion},e.prototype.cameraModeChanged=function(x){this._cameraMode=x.cameraMode},e}();!function(x){x.HitFirst="rqhf",x.HitAll="rqha"}(Pe||(Pe={}));var Fe,Le=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(x){var T=Oe.instance.rotation,R=Pt.Identity();T.toRotationMatrix(R);var A=Ot.TransformCoordinates(Ot.Forward(),R);return{origin:Oe.instance.position,direction:A,distance:x}},t.prototype.getRayFromPositions=function(x,T){var R=T.subtract(x),A=R.length();return{origin:x,direction:R.normalize(),distance:A}},t.prototype.hitFirst=function(x,T,R){var A="number"==typeof R?Pe.HitFirst+R:y();this.queries[A]=T,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:A,queryType:"HitFirst",ray:x})},t.prototype.hitAll=function(x,T,R){var A="number"==typeof R?Pe.HitAll+R:y();this.queries[A]=T,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:A,queryType:"HitAll",ray:x})},t.prototype.hitFirstAvatar=function(x,T){l("not implemented yet")},t.prototype.hitAllAvatars=function(x,T){l("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(x){this.queries[x.payload.queryId](x.payload.payload),delete this.queries[x.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(x){this.queries[x.payload.queryId](x.payload.payload),delete this.queries[x.payload.queryId]},t}(),Ne=function(){function t(){}return t.prototype.activate=function(x){x.eventManager.addListener(it,this,(function(x){"HitFirst"===x.payload.queryType?Le.instance.handleRaycastHitFirstResponse(x):"HitAll"===x.payload.queryType&&Le.instance.handleRaycastHitAllResponse(x)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}(),De=function(){function t(){}return t.prototype.activate=function(x){x.eventManager.addListener(rt,this,(function(x){ee.instance.handlePointerEvent(x.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("pointerEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("pointerEvent"))},t}(),Ue=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(x){x.eventManager.addListener(ot,this,this.handleEvent),x.eventManager.addListener(I,this,this.componentAdded),x.eventManager.addListener(C,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(x){for(var T in x.components){var R=x.components[T];R instanceof Ae&&(this.handlerMap[R.uuid]=R)}},t.prototype.onRemoveEntity=function(x){for(var T in x.components){var R=x.components[T];R instanceof Ae&&delete this.handlerMap[R.uuid]}},t.prototype.componentAdded=function(x){if(x.entity.isAddedToEngine()){var T=x.entity.components[x.componentName];T instanceof Ae&&(this.handlerMap[T.uuid]=T)}},t.prototype.componentRemoved=function(x){x.entity.isAddedToEngine()&&x.component instanceof Ae&&delete this.handlerMap[x.component.uuid]},t.prototype.handleEvent=function(x){if(x.uuid in this.handlerMap){var T=this.handlerMap[x.uuid];T&&T.callback&&"call"in T.callback&&T.callback(x.payload)}},t}(),Be=new Ne,He=new De,ke=new Ue,Ve=function(T){function n(x){var R=T.call(this)||this;return R.loop=!1,R.volume=1,R.url=x,R}return o(n,T),r([G.readonly],n.prototype,"url",void 0),r([G.field],n.prototype,"loop",void 0),r([G.field],n.prototype,"loadingCompleteEventId",void 0),r([G.field],n.prototype,"volume",void 0),r([F("engine.AudioClip",x.CLASS_ID.AUDIO_CLIP)],n)}(G),We=function(T){function n(x){var R=T.call(this)||this;if(R.audioClip=x,R.loop=!1,R.volume=1,R.playing=!1,R.pitch=1,R.playedAtTimestamp=Date.now(),!(x instanceof Ve))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return R.audioClipId=D(x),R}return o(n,T),n.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},r([G.readonly],n.prototype,"audioClipId",void 0),r([G.field],n.prototype,"loop",void 0),r([G.field],n.prototype,"volume",void 0),r([G.field],n.prototype,"playing",void 0),r([G.field],n.prototype,"pitch",void 0),r([G.field],n.prototype,"playedAtTimestamp",void 0),r([M("engine.AudioSource",x.CLASS_ID.AUDIO_SOURCE)],n)}(G),qe=function(T){function n(x){var R=T.call(this)||this;return R.playing=!1,R.volume=1,R.url=x,R.playing=!0,R}return o(n,T),r([G.readonly],n.prototype,"url",void 0),r([G.field],n.prototype,"playing",void 0),r([G.field],n.prototype,"volume",void 0),r([M("engine.AudioStream",x.CLASS_ID.AUDIO_STREAM)],n)}(G);x.Gizmo=void 0,(Fe=x.Gizmo||(x.Gizmo={})).MOVE="MOVE",Fe.ROTATE="ROTATE",Fe.SCALE="SCALE",Fe.NONE="NONE";var Ge,je=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.type="gizmoEvent",x}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.gizmoEvent",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),Ye=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.position=!0,x.rotation=!0,x.scale=!0,x.cycle=!0,x.localReference=!1,x}return o(n,T),r([G.field],n.prototype,"position",void 0),r([G.field],n.prototype,"rotation",void 0),r([G.field],n.prototype,"scale",void 0),r([G.field],n.prototype,"cycle",void 0),r([G.field],n.prototype,"selectedGizmo",void 0),r([G.field],n.prototype,"localReference",void 0),r([M("engine.gizmos",x.CLASS_ID.GIZMOS)],n)}(G),Xe=function(x){function e(T){var R=x.call(this)||this;return R.name=null,R.visible=!0,R.opacity=1,R.hAlign="center",R.vAlign="center",R.width="100px",R.height="50px",R.positionX="0px",R.positionY="0px",R.isPointerBlocker=!0,T&&(R._parent=T,R.data.parentComponent=D(T)),R}return o(e,x),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),r([G.field],e.prototype,"name",void 0),r([G.field],e.prototype,"visible",void 0),r([G.field],e.prototype,"opacity",void 0),r([G.field],e.prototype,"hAlign",void 0),r([G.field],e.prototype,"vAlign",void 0),r([G.uiValue],e.prototype,"width",void 0),r([G.uiValue],e.prototype,"height",void 0),r([G.uiValue],e.prototype,"positionX",void 0),r([G.uiValue],e.prototype,"positionY",void 0),r([G.field],e.prototype,"isPointerBlocker",void 0),e}(G),Ze=function(T){function n(){return T.call(this,null)||this}return o(n,T),r([F("engine.shape",x.CLASS_ID.UI_FULLSCREEN_SHAPE)],n)}(Xe),Je=function(T){function n(){return T.call(this,null)||this}return o(n,T),r([F("engine.shape",x.CLASS_ID.UI_WORLD_SPACE_SHAPE)],n)}(Xe),Qe=function(T){function n(){return T.call(this,null)||this}return o(n,T),r([F("engine.shape",x.CLASS_ID.UI_SCREEN_SPACE_SHAPE)],n)}(Xe),Ke=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.adaptWidth=!1,x.adaptHeight=!1,x.thickness=0,x.color=Bt.Clear(),x.alignmentUsesSize=!0,x}return o(n,T),r([G.field],n.prototype,"adaptWidth",void 0),r([G.field],n.prototype,"adaptHeight",void 0),r([G.field],n.prototype,"thickness",void 0),r([G.field],n.prototype,"color",void 0),r([G.field],n.prototype,"alignmentUsesSize",void 0),r([F("engine.shape",x.CLASS_ID.UI_CONTAINER_RECT)],n)}(Xe);x.UIStackOrientation=void 0,(Ge=x.UIStackOrientation||(x.UIStackOrientation={}))[Ge.VERTICAL=0]="VERTICAL",Ge[Ge.HORIZONTAL=1]="HORIZONTAL";var $e=function(T){function n(){var R=null!==T&&T.apply(this,arguments)||this;return R.adaptWidth=!0,R.adaptHeight=!0,R.color=Bt.Clear(),R.stackOrientation=x.UIStackOrientation.VERTICAL,R.spacing=0,R}return o(n,T),r([G.field],n.prototype,"adaptWidth",void 0),r([G.field],n.prototype,"adaptHeight",void 0),r([G.field],n.prototype,"color",void 0),r([G.field],n.prototype,"stackOrientation",void 0),r([G.field],n.prototype,"spacing",void 0),r([F("engine.shape",x.CLASS_ID.UI_CONTAINER_STACK)],n)}(Xe),tn=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.fontSize=10,x.fontWeight="normal",x.thickness=0,x.cornerRadius=0,x.color=Bt.White(),x.background=Bt.White(),x.paddingTop=0,x.paddingRight=0,x.paddingBottom=0,x.paddingLeft=0,x.shadowBlur=0,x.shadowOffsetX=0,x.shadowOffsetY=0,x.shadowColor=Bt.Black(),x.text="button",x}return o(n,T),r([G.field],n.prototype,"fontSize",void 0),r([G.field],n.prototype,"fontWeight",void 0),r([G.field],n.prototype,"thickness",void 0),r([G.field],n.prototype,"cornerRadius",void 0),r([G.field],n.prototype,"color",void 0),r([G.field],n.prototype,"background",void 0),r([G.field],n.prototype,"paddingTop",void 0),r([G.field],n.prototype,"paddingRight",void 0),r([G.field],n.prototype,"paddingBottom",void 0),r([G.field],n.prototype,"paddingLeft",void 0),r([G.field],n.prototype,"shadowBlur",void 0),r([G.field],n.prototype,"shadowOffsetX",void 0),r([G.field],n.prototype,"shadowOffsetY",void 0),r([G.field],n.prototype,"shadowColor",void 0),r([G.field],n.prototype,"text",void 0),r([F("engine.shape",x.CLASS_ID.UI_BUTTON_SHAPE)],n)}(Xe),en=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.outlineWidth=0,x.outlineColor=Bt.White(),x.color=Bt.White(),x.fontSize=10,x.fontAutoSize=!1,x.fontWeight="normal",x.value="",x.lineSpacing=0,x.lineCount=0,x.adaptWidth=!1,x.adaptHeight=!1,x.textWrapping=!1,x.shadowBlur=0,x.shadowOffsetX=0,x.shadowOffsetY=0,x.shadowColor=Bt.Black(),x.hTextAlign="left",x.vTextAlign="bottom",x.paddingTop=0,x.paddingRight=0,x.paddingBottom=0,x.paddingLeft=0,x}return o(n,T),r([G.field],n.prototype,"outlineWidth",void 0),r([G.field],n.prototype,"outlineColor",void 0),r([G.field],n.prototype,"color",void 0),r([G.field],n.prototype,"fontSize",void 0),r([G.field],n.prototype,"fontAutoSize",void 0),r([G.field],n.prototype,"fontWeight",void 0),r([G.component],n.prototype,"font",void 0),r([G.field],n.prototype,"value",void 0),r([G.field],n.prototype,"lineSpacing",void 0),r([G.field],n.prototype,"lineCount",void 0),r([G.field],n.prototype,"adaptWidth",void 0),r([G.field],n.prototype,"adaptHeight",void 0),r([G.field],n.prototype,"textWrapping",void 0),r([G.field],n.prototype,"shadowBlur",void 0),r([G.field],n.prototype,"shadowOffsetX",void 0),r([G.field],n.prototype,"shadowOffsetY",void 0),r([G.field],n.prototype,"shadowColor",void 0),r([G.field],n.prototype,"hTextAlign",void 0),r([G.field],n.prototype,"vTextAlign",void 0),r([G.field],n.prototype,"paddingTop",void 0),r([G.field],n.prototype,"paddingRight",void 0),r([G.field],n.prototype,"paddingBottom",void 0),r([G.field],n.prototype,"paddingLeft",void 0),r([F("engine.shape",x.CLASS_ID.UI_TEXT_SHAPE)],n)}(Xe),nn=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.outlineWidth=0,x.outlineColor=Bt.Black(),x.color=Bt.Clear(),x.thickness=1,x.fontSize=10,x.fontWeight="normal",x.value="",x.placeholderColor=Bt.White(),x.placeholder="",x.margin=10,x.maxWidth=100,x.hTextAlign="left",x.vTextAlign="bottom",x.autoStretchWidth=!0,x.background=Bt.Black(),x.focusedBackground=Bt.Black(),x.textWrapping=!1,x.shadowBlur=0,x.shadowOffsetX=0,x.shadowOffsetY=0,x.shadowColor=Bt.White(),x.paddingTop=0,x.paddingRight=0,x.paddingBottom=0,x.paddingLeft=0,x.onTextSubmit=null,x.onChanged=null,x.onFocus=null,x.onBlur=null,x}return o(n,T),r([G.field],n.prototype,"outlineWidth",void 0),r([G.field],n.prototype,"outlineColor",void 0),r([G.field],n.prototype,"color",void 0),r([G.field],n.prototype,"thickness",void 0),r([G.field],n.prototype,"fontSize",void 0),r([G.field],n.prototype,"fontWeight",void 0),r([G.component],n.prototype,"font",void 0),r([G.field],n.prototype,"value",void 0),r([G.field],n.prototype,"placeholderColor",void 0),r([G.field],n.prototype,"placeholder",void 0),r([G.field],n.prototype,"margin",void 0),r([G.field],n.prototype,"maxWidth",void 0),r([G.field],n.prototype,"hTextAlign",void 0),r([G.field],n.prototype,"vTextAlign",void 0),r([G.field],n.prototype,"autoStretchWidth",void 0),r([G.field],n.prototype,"background",void 0),r([G.field],n.prototype,"focusedBackground",void 0),r([G.field],n.prototype,"textWrapping",void 0),r([G.field],n.prototype,"shadowBlur",void 0),r([G.field],n.prototype,"shadowOffsetX",void 0),r([G.field],n.prototype,"shadowOffsetY",void 0),r([G.field],n.prototype,"shadowColor",void 0),r([G.field],n.prototype,"paddingTop",void 0),r([G.field],n.prototype,"paddingRight",void 0),r([G.field],n.prototype,"paddingBottom",void 0),r([G.field],n.prototype,"paddingLeft",void 0),r([Ae.uuidEvent],n.prototype,"onTextSubmit",void 0),r([Ae.uuidEvent],n.prototype,"onChanged",void 0),r([Ae.uuidEvent],n.prototype,"onFocus",void 0),r([Ae.uuidEvent],n.prototype,"onBlur",void 0),r([F("engine.shape",x.CLASS_ID.UI_INPUT_TEXT_SHAPE)],n)}(Xe),on=function(T){function n(x,R){var A=T.call(this,x)||this;return A.sourceLeft=0,A.sourceTop=0,A.sourceWidth=1,A.sourceHeight=1,A.paddingTop=0,A.paddingRight=0,A.paddingBottom=0,A.paddingLeft=0,A.sizeInPixels=!0,A.onClick=null,A.source=R,A}return o(n,T),r([G.field],n.prototype,"sourceLeft",void 0),r([G.field],n.prototype,"sourceTop",void 0),r([G.field],n.prototype,"sourceWidth",void 0),r([G.field],n.prototype,"sourceHeight",void 0),r([G.component],n.prototype,"source",void 0),r([G.field],n.prototype,"paddingTop",void 0),r([G.field],n.prototype,"paddingRight",void 0),r([G.field],n.prototype,"paddingBottom",void 0),r([G.field],n.prototype,"paddingLeft",void 0),r([G.field],n.prototype,"sizeInPixels",void 0),r([Ae.uuidEvent],n.prototype,"onClick",void 0),r([F("engine.shape",x.CLASS_ID.UI_IMAGE_SHAPE)],n)}(Xe),rn=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.valueX=0,x.valueY=0,x.borderColor=Bt.White(),x.backgroundColor=Bt.Clear(),x.isHorizontal=!1,x.isVertical=!1,x.paddingTop=0,x.paddingRight=0,x.paddingBottom=0,x.paddingLeft=0,x.onChanged=null,x}return o(n,T),r([G.field],n.prototype,"valueX",void 0),r([G.field],n.prototype,"valueY",void 0),r([G.field],n.prototype,"borderColor",void 0),r([G.field],n.prototype,"backgroundColor",void 0),r([G.field],n.prototype,"isHorizontal",void 0),r([G.field],n.prototype,"isVertical",void 0),r([G.field],n.prototype,"paddingTop",void 0),r([G.field],n.prototype,"paddingRight",void 0),r([G.field],n.prototype,"paddingBottom",void 0),r([G.field],n.prototype,"paddingLeft",void 0),r([Ae.uuidEvent],n.prototype,"onChanged",void 0),r([F("engine.shape",x.CLASS_ID.UI_SLIDER_SHAPE)],n)}(Xe),sn=function(T){function n(){var x=null!==T&&T.apply(this,arguments)||this;return x.useDummyModel=!1,x.talking=!1,x}var R;return o(n,T),R=n,n.Dummy=function(){var x=new R;return x.useDummyModel=!0,x},r([G.field],n.prototype,"id",void 0),r([G.field],n.prototype,"name",void 0),r([G.field],n.prototype,"expressionTriggerId",void 0),r([G.field],n.prototype,"expressionTriggerTimestamp",void 0),r([G.field],n.prototype,"bodyShape",void 0),r([G.field],n.prototype,"wearables",void 0),r([G.field],n.prototype,"skinColor",void 0),r([G.field],n.prototype,"hairColor",void 0),r([G.field],n.prototype,"eyeColor",void 0),r([G.field],n.prototype,"useDummyModel",void 0),r([G.field],n.prototype,"talking",void 0),R=r([M("engine.avatarShape",x.CLASS_ID.AVATAR_SHAPE)],n)}(G),an=function(T){function n(x){var R=T.call(this,x)||this;return R.type="onFocus",ke.handlerMap[R.uuid]=R,R}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onFocus",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),un=function(T){function n(x){var R=T.call(this,x)||this;return R.type="onTextSubmit",ke.handlerMap[R.uuid]=R,R}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onTextSubmit",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),pn=function(T){function n(x){var R=T.call(this,x)||this;return R.type="onBlur",ke.handlerMap[R.uuid]=R,R}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onBlur",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),hn=function(T){function n(x){var R=T.call(this,x)||this;return R.type="onEnter",ke.handlerMap[R.uuid]=R,R}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onEnter",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),ln=function(T){function n(x){var R=T.call(this,x)||this;return R.type="onChange",ke.handlerMap[R.uuid]=R,R}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onChange",x.CLASS_ID.UUID_CALLBACK)],n)}(Ae),cn=function(T){function n(x,R){var A=T.call(this,x)||this;return A.type="onClick",ke.handlerMap[A.uuid]=A,R&&(A.showFeedback=!(!1===R.showFeedback),R.button&&(A.button=R.button),R.hoverText&&(A.hoverText=R.hoverText),R.distance&&(A.distance=R.distance)),A}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.onClick",x.CLASS_ID.UUID_CALLBACK)],n)}(Ee),fn=function(T){function n(x,R){var A=T.call(this,x)||this;return A.type="pointerDown",ke.handlerMap[A.uuid]=A,R&&(A.showFeedback=!(!1===R.showFeedback),R.button&&(A.button=R.button),R.hoverText&&(A.hoverText=R.hoverText),R.distance&&(A.distance=R.distance)),A}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.pointerDown",x.CLASS_ID.UUID_CALLBACK)],n)}(Ee),yn=function(T){function n(x,R){var A=T.call(this,x)||this;return A.type="pointerUp",ke.handlerMap[A.uuid]=A,R&&(A.showFeedback=!(!1===R.showFeedback),R.button&&(A.button=R.button),R.hoverText&&(A.hoverText=R.hoverText),R.distance&&(A.distance=R.distance)),A}return o(n,T),r([G.readonly],n.prototype,"type",void 0),r([M("engine.pointerUp",x.CLASS_ID.UUID_CALLBACK)],n)}(Ee),vn=null,mn=null,gn=null;function dn(){return gn||(gn=new nt),gn}var wn=function(){function t(){var x=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!mn){(mn=dcl.loadModule("@decentraland/CommunicationsController",{})).then((function(x){vn=x}));var x=dn();dcl.subscribe("comms"),dcl.onEvent((function(T){"comms"===T.type&&x.notifyObservers(T.data)}))}return mn}().then((function(T){x.connected=!0,x.flush()}))}return t.prototype.on=function(x,T){return dn().add((function(R){try{var A=JSON.parse(R.message);A.message===x&&T(A.payload,R.sender)}catch(R){dcl.error("Error parsing comms message "+(R.message||""),R)}}))},t.prototype.sendRaw=function(x){this.messageQueue.push(x),this.connected&&this.flush()},t.prototype.emit=function(x,T){var R=JSON.stringify({message:x,payload:T});this.sendRaw(R),dn().notifyObservers({message:R,sender:"self"})},t.prototype.flush=function(){var x=this;if(0!==this.messageQueue.length&&this.connected&&vn&&!this.flushing){var T=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(vn.rpcHandle,"send",[T]).then((function(T){x.flushing=!1,x.flush()}),(function(T){x.flushing=!1,d("Error flushing MessageBus",T)}))}},t}(),_n=new X("scene");_n.uuid="0";var xn=new Z(_n);F.engine=xn,"undefined"!=typeof dcl&&(xn.addSystem(new gt(dcl),1/0),ht(dcl)),xn.addSystem(ke),xn.addSystem(He),xn.addSystem(Be),x.AVATAR_OBSERVABLE="AVATAR_OBSERVABLE",x.Angle=Lt,x.AnimationState=Jt,x.Animator=me,x.Arc2=It,x.Attachable=T,x.AudioClip=Ve,x.AudioSource=We,x.AudioStream=qe,x.AvatarModifierArea=oe,x.AvatarShape=sn,x.Axis=Dt,x.BasicMaterial=Re,x.BezierCurve=Ut,x.Billboard=re,x.BoxShape=ae,x.Camera=Oe,x.CircleShape=pe,x.Color3=Ht,x.Color4=Bt,x.Component=M,x.ComponentAdded=I,x.ComponentGroup=j,x.ComponentRemoved=C,x.ConeShape=le,x.Curve3=kt,x.CylinderShape=de,x.DEG2RAD=Et,x.DisposableComponent=F,x.DisposableComponentCreated=k,x.DisposableComponentRemoved=V,x.DisposableComponentUpdated=W,x.Engine=Z,x.Entity=X,x.Epsilon=At,x.EventConstructor=w,x.EventManager=E,x.Font=we,x.Frustum=Wt,x.GLTFShape=ce,x.Gizmos=Ye,x.GlobalPointerDown=$t,x.GlobalPointerUp=te,x.Input=ee,x.Material=be,x.MathTmp=Ft,x.Matrix=Pt,x.MessageBus=wn,x.MultiObserver=et,x.NFTShape=ye,x.OBJShape=ge,x.Observable=nt,x.ObservableComponent=G,x.Observer=Y,x.ObserverEventState=$,x.OnAnimationEnd=Ce,x.OnBlur=pn,x.OnChanged=ln,x.OnClick=cn,x.OnEnter=hn,x.OnFocus=an,x.OnGizmoEvent=je,x.OnPointerDown=fn,x.OnPointerLock=Se,x.OnPointerUUIDEvent=Ee,x.OnPointerUp=yn,x.OnTextSubmit=un,x.OnUUIDEvent=Ae,x.ParentChanged=z,x.Path2=qt,x.Path3D=Gt,x.PhysicsCast=Le,x.Plane=Vt,x.PlaneShape=he,x.PointerEvent=rt,x.PointerEventComponent=jt,x.PointerEventSystem=De,x.Quaternion=Mt,x.RAD2DEG=St,x.RaycastEventSystem=Ne,x.RaycastResponse=it,x.Scalar=Ct,x.Shape=se,x.Size=Yt,x.SmartItem=Ie,x.SphereShape=ue,x.Subscription=Zt,x.TextShape=xe,x.Texture=ve,x.ToGammaSpace=bt,x.ToLinearSpace=Rt,x.Transform=ie,x.UIButton=tn,x.UICanvas=Qe,x.UIContainerRect=Ke,x.UIContainerStack=$e,x.UIFullScreen=Ze,x.UIImage=on,x.UIInputText=nn,x.UIScrollRect=rn,x.UIShape=Xe,x.UIText=en,x.UIValue=P,x.UIWorldSpace=Je,x.UUIDEvent=ot,x.UUIDEventSystem=Ue,x.Vector2=Nt,x.Vector3=Ot,x.Vector4=zt,x.VideoClip=ze,x.VideoTexture=Me,x._initEventObservables=ht,x.buildArray=v,x.engine=xn,x.error=d,x.executeTask=q,x.getComponentClassId=N,x.getComponentId=D,x.getComponentName=L,x.getMessageObserver=dn,x.isDisposableComponent=B,x.log=l,x.newId=f,x.onCameraModeChangedObservable=st,x.onEnterScene=pt,x.onEnterSceneObservable=ut,x.onIdleStateChangedObservable=at,x.onLeaveScene=dt,x.onLeaveSceneObservable=lt,x.onPlayerExpressionObservable=ft,x.onSceneReadyObservable=ct,x.onVideoEvent=yt,x.openExternalURL=function(x){"undefined"!=typeof dcl?dcl.openExternalUrl(x):d("ERROR: openExternalURL dcl is undefined")},x.openNFTDialog=function(x,T){if(void 0===T&&(T=null),"undefined"!=typeof dcl){var R=x.match(/ethereum:\/\/(.+)\/(.+)/);if(!R||R.length<3)return;dcl.openNFTDialog(R[1],R[2],T)}else d("ERROR: openNFTDialog dcl is undefined")},x.pointerEventSystem=He,x.raycastEventSystem=Be,x.teleportTo=function(x){var T;T=[x],void 0===Q&&"undefined"!=typeof dcl&&(Q=dcl.loadModule("@decentraland/UserActionModule",{})),void 0!==Q&&"undefined"!=typeof dcl&&Q.then((function(x){dcl.callRpc(x.rpcHandle,"requestTeleport",T)}))},x.uuid=y,x.uuidEventSystem=ke,Object.defineProperty(x,"__esModule",{value:!0})}(this.globalThis=this.globalThis||{});var __values=this&&this.__values||function(x){var T="function"==typeof Symbol&&Symbol.iterator,R=T&&x[T],A=0;if(R)return R.call(x);if(x&&"number"==typeof x.length)return{next:function(){return x&&A>=x.length&&(x=void 0),{value:x&&x[A++],done:!x}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")};dcl.log("hello from game.ts"),log("hello");var RotatorSystem=function(){function RotatorSystem(){this.group=engine.getComponentGroup(Transform)}return RotatorSystem.prototype.update=function(x){var T,R;try{for(var A=__values(this.group.entities),E=A.next();!E.done;E=A.next())E.value.getComponent(Transform).rotate(Vector3.Up(),10*x)}catch(x){T={error:x}}finally{try{E&&!E.done&&(R=A.return)&&R.call(A)}finally{if(T)throw T.error}}},RotatorSystem}();function spawnCube(x,T,R){var A=new Entity;return A.addComponent(new Transform({position:new Vector3(x,T,R)})),A.addComponent(new BoxShape),engine.addEntity(A),A}engine.addSystem(new RotatorSystem);var cube=spawnCube(8,1,8);cube.addComponent(new OnClick((function(){cube.getComponent(Transform).scale.z*=1.1,cube.getComponent(Transform).scale.x*=.9,spawnCube(8*Math.random()+1,8*Math.random(),8*Math.random()+1)})));